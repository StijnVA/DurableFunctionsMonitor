{"version":3,"sources":["logo.svg","../node_modules/moment-mini/locale sync /^/.*$","registerServiceWorker.ts","components/LoginIcon.tsx","components/ErrorMessage.tsx","components/MainMenu.tsx","DateTimeHelpers.ts","states/DurableOrchestrationStatus.ts","states/OrchestrationsState.ts","components/OrchestrationLink.tsx","states/ErrorMessageState.ts","components/Orchestrations.tsx","components/DurableEntityButtons.tsx","components/DurableEntityFields.tsx","components/OrchestrationButtons.tsx","components/OrchestrationFields.tsx","components/OrchestrationDetails.tsx","components/PurgeHistoryDialog.tsx","components/CleanEntityStorageDialog.tsx","components/Main.tsx","services/BackendClient.ts","states/LoginState.ts","states/MainMenuState.ts","states/SequenceDiagramTabState.ts","states/LiquidMarkupTabState.ts","states/OrchestrationDetailsState.ts","states/PurgeHistoryDialogState.ts","states/CleanEntityStorageDialogState.ts","states/TypedLocalStorage.ts","services/VsCodeBackendClient.ts","states/VsCodeTypedLocalStorage.ts","index.tsx","states/MainState.ts"],"names":["module","exports","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","catch","error","LoginIcon","observer","React","render","this","props","Button","color","isLoggedInAnonymously","onClick","evt","menuAnchorElement","currentTarget","AccountCircle","Box","width","Tooltip","title","Typography","userName","Menu","anchorEl","keepMounted","open","onClose","undefined","MenuItem","logout","Dialog","isLoggedIn","DialogContent","errorMessage","Container","className","CircularProgress","DialogContentText","fontSize","ErrorMessage","action","bound","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","handleClose","SnackbarContent","message","IconButton","key","aria-label","MainMenu","componentDidMount","setWindowTitle","showConnectionParamsDialog","showPurgeHistoryDialog","showCleanEntityStorageDialog","connectionParamsDialogOpen","DialogTitle","inProgress","LinearProgress","height","isReadonly","TextField","autoFocus","margin","label","fullWidth","disabled","InputProps","readOnly","InputLabelProps","shrink","value","hubName","onChange","target","connectionString","DialogActions","saveConnectionParams","isDirty","DateTimeHelpers","t","isValid","result","moment","toISOString","slice","utc","isAfter","MinMoment","isBefore","MaxMoment","dt","HistoryEventFields","DurableOrchestrationStatus","instanceId","name","entityId","runtimeStatus","entityType","lastEvent","input","customStatus","output","createdTime","lastUpdatedTime","historyEvents","tabTemplateNames","FilterOperatorEnum","ShowEntityTypeEnum","DurableOrchestrationStatusFields","OrchestrationLink","backendClient","isVsCode","Link","href","onLinkClicked","orchestrationId","extraSanitizeHrefComponent","call","s","replace","ErrorMessageState","observable","OrchestrationsState","_inProgress","_orchestrations","_autoRefresh","val","_localStorage","setItem","toString","loadOrchestrations","_timeFrom","resetOrderBy","_timeTill","reloadOrchestrations","_orderByDirection","_orderBy","_filterValue","_filterOperator","_filteredColumn","_showEntityType","_oldFilterValue","_backendClient","constructor","momentFrom","super","_noMorePagesToLoad","_pageSize","_autoRefreshToken","_oldTimeFrom","_oldTimeTill","timeFromString","getItem","subtract","timeTillString","filteredColumnString","filterOperatorString","filterValueString","showEntityTypeString","autoRefreshString","Number","orderByString","orderByDirectionString","applyTimeFrom","isValidMoment","applyTimeTill","applyFilterValue","setItems","fieldName","isAutoRefresh","timeFrom","timeTill","filterClause","OrchestrationsOnly","DurableEntitiesOnly","Equals","StartsWith","Contains","skip","length","orderByClause","orderByDirection","uri","response","push","clearTimeout","setTimeout","err","data","finally","computed","ShowBoth","Orchestrations","document","addEventListener","scrollingElement","scrollHeight","innerHeight","scrollTop","Toolbar","variant","Grid","container","item","xs","style","marginLeft","ampm","autoOk","invalidDateMessage","format","momentAsUtc","onBlur","onAccept","onKeyPress","handleKeyPress","FormControl","InputLabel","htmlFor","Checkbox","checked","timeTillEnabled","placeholder","type","Select","filteredColumn","inputProps","col","filterOperator","filterValue","RadioGroup","showEntityType","FormControlLabel","control","Radio","flex","autoRefresh","size","FormHelperText","orchestrations","renderTable","renderEmptyTable","Table","TableHead","TableRow","filter","f","showLastEventColumn","TableCell","TableSortLabel","active","orderBy","direction","TableBody","orchestration","cellStyle","verticalAlign","toLowerCase","InputBase","multiline","rowsMax","JSON","stringify","event","preventDefault","DurableEntityButtons","renderDialogs","purgeConfirmationOpen","purge","DurableEntityFields","details","sm","md","zeroMinWidth","OrchestrationButtons","rewindConfirmationOpen","terminateConfirmationOpen","raiseEventDialogOpen","setCustomStatusDialogOpen","rewind","terminate","eventName","rows","eventData","raiseEvent","newCustomStatus","setCustomStatus","isCustomStatusDirty","OrchestrationFields","events","index","Timestamp","EventType","SubOrchestrationId","FunctionName","Name","ScheduledTime","Result","Details","OrchestrationDetails","loadDetails","tabStates","AppBar","position","Tabs","selectedTabIndex","ev","Tab","tabState","selectedTab","rawHtml","dangerouslySetInnerHTML","__html","description","PurgeHistoryDialog","dialogOpen","instancesDeleted","FormLabel","row","FormGroup","purgeHistory","RuntimeStatusCheckbox","getStatusIncluded","setStatusIncluded","CleanEntityStorageDialog","removeEmptyEntities","releaseOrphanedLocks","clean","numberOfEmptyEntitiesRemoved","numberOfOrphanedLocksRemoved","logo","require","Main","utils","MomentUtils","loginState","mainMenuState","src","Breadcrumbs","orchestrationDetailsState","orchestrationsState","purgeHistoryDialogState","cleanEntityStorageDialogState","BackendClient","_getAuthorizationHeaderAsync","method","url","Promise","reject","headers","axios","request","process","r","LoginState","_isLoggedIn","_userName","_aadApp","login","get","loginWithEasyAuthConfig","getAuthorizationHeaderAsync","authParams","scopes","getCurrentConfiguration","auth","clientId","acquireTokenSilent","authResponse","accessToken","idToken","rawIdToken","Authorization","acquireTokenRedirect","easyAuthConfigResponse","config","Msal","authority","handleRedirectCallback","handleRedirectCallbackFailed","account","getAccount","loginRedirect","authErr","accountState","errorCode","MainMenuState","_isReadOnly","_oldConnectionString","_oldHubName","_purgeHistoryDialogState","_cleanEntityStorageDialogState","isReadOnly","alert","accountName","version","SequenceDiagramTabState","_sequenceDiagramCode","_sequenceDiagramSvg","_loadDetails","_mermaidInitialized","load","mermaid","initialize","startOnLoad","all","getSequenceForOrchestration","sequenceLines","sequenceCode","join","svg","orchestrationName","parentOrchestrationName","results","nextLine","subOrchestrationName","LiquidMarkupTabState","_rawHtml","_orchestrationId","OrchestrationDetailsState","_selectedTabIndex","loadCustomTabIfNeeded","_tabStates","_raiseEventDialogOpen","_setCustomStatusDialogOpen","requestBody","parse","setAutoRefresh","internalLoadDetails","orchId","templateName","history","PurgeHistoryDialogState","_dialogOpen","_instancesDeleted","_statuses","Set","statuses","Array","from","values","status","has","included","add","delete","CleanEntityStorageDialogState","isOpen","_response","TypedLocalStorage","_prefix","localStorage","items","removeItem","VsCodeBackendClient","_vsCodeApi","_handlers","_requests","requestHandler","requestPromise","requestId","Math","random","postMessage","setCustomHandlers","purgeHistoryHandler","cleanEntityStorageHandler","VsCodeTypedLocalStorage","oldState","getState","State","setState","appState","vsCodeApi","acquireVsCodeApi","OrchestrationIdFromVsCode","pathname","startsWith","substr","ReactDOM","getElementById","URL","origin","fetch","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.16268b0e.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.9b5d7869.svg\";","var map = {\n\t\"./locale\": 243,\n\t\"./locale.js\": 243\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 521;","// tslint:disable:no-console\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the 'N+1' visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL!,\n      window.location.toString()\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker) {\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n                // At this point, the old content will have been purged and\n                // the fresh content will have been added to the cache.\n                // It's the perfect time to display a 'New content is\n                // available; please refresh.' message in your web app.\n                console.log('New content is available; please refresh.');\n              } else {\n                // At this point, everything has been precached.\n                // It's the perfect time to display a\n                // 'Content is cached for offline use.' message.\n                console.log('Content is cached for offline use.');\n              }\n            }\n          };\n        }\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type')!.indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Button, Container, CircularProgress, Dialog, DialogContent, DialogContentText,\r\n    Menu, MenuItem, Tooltip, Typography\r\n} from '@material-ui/core';\r\n\r\nimport { AccountCircle, Error } from '@material-ui/icons';\r\n\r\nimport './LoginIcon.css';\r\n\r\nimport { LoginState } from '../states/LoginState';\r\n\r\n// Main Menu view\r\n@observer\r\nexport class LoginIcon extends React.Component<{ state: LoginState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <div>\r\n                <Button color={state.isLoggedInAnonymously ? \"secondary\" : \"inherit\"}\r\n                    onClick={evt => state.menuAnchorElement = evt.currentTarget}\r\n                >\r\n                    <AccountCircle />\r\n                    <Box width={5} />\r\n                    <Tooltip title={state.isLoggedInAnonymously ? \"Ensure this endpoint is not exposed to the public!\" : \"\"} >\r\n                        <Typography color={state.isLoggedInAnonymously ? \"secondary\" : \"inherit\"} >\r\n                            {state.isLoggedInAnonymously ? \"Anonymous\" : state.userName}\r\n                        </Typography>\r\n                    </Tooltip>\r\n                </Button>\r\n\r\n                {!state.isLoggedInAnonymously && (\r\n                    <Menu\r\n                        anchorEl={state.menuAnchorElement}\r\n                        keepMounted\r\n                        open={!!state.menuAnchorElement}\r\n                        onClose={() => state.menuAnchorElement = undefined}\r\n                    >\r\n                        <MenuItem onClick={() => state.logout()}>Login under a different name</MenuItem>\r\n                    </Menu>\r\n                )}\r\n\r\n                <Dialog open={!state.isLoggedIn}>\r\n                    <DialogContent>\r\n\r\n                        {!state.errorMessage && (\r\n                            <div>\r\n                                <Container className=\"login-progress\">\r\n                                    <CircularProgress />\r\n                                </Container>\r\n                                <DialogContentText>Login in progress...</DialogContentText>\r\n                            </div>)}\r\n\r\n                        {!!state.errorMessage && (\r\n                            <div>\r\n                                <Container className=\"login-progress\">\r\n                                    <Error color=\"secondary\" fontSize=\"large\" />\r\n                                </Container>\r\n                                <DialogContentText color=\"secondary\">Login failed. {state.errorMessage}</DialogContentText>\r\n                            </div>)}\r\n\r\n                    </DialogContent>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\nimport { action } from 'mobx'\r\nimport { observer } from 'mobx-react';\r\n\r\nimport { IconButton, Snackbar, SnackbarContent } from '@material-ui/core';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\n\r\nimport './ErrorMessage.css';\r\n\r\nimport { ErrorMessageState } from '../states/ErrorMessageState';\r\n\r\n// Error Message Snackbar\r\n@observer\r\nexport class ErrorMessage extends React.Component<{ state: ErrorMessageState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n\r\n            <Snackbar\r\n                className=\"message-snackbar\"\r\n                anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n                open={!!state.errorMessage}\r\n                autoHideDuration={6000}\r\n                onClose={this.handleClose}\r\n            >\r\n                <SnackbarContent\r\n                    className=\"error-snackbar-content\"\r\n                    message={\r\n                        <span>\r\n                            <ErrorIcon className=\"error-icon\" />\r\n                            {state.errorMessage}\r\n                        </span>\r\n                    }\r\n                    action={[\r\n                        <IconButton\r\n                            key=\"close\"\r\n                            aria-label=\"Close\"\r\n                            color=\"inherit\"\r\n                            onClick={this.handleClose}\r\n                        >\r\n                            <CloseIcon />\r\n                        </IconButton>,\r\n                    ]}\r\n                />\r\n\r\n            </Snackbar>\r\n        );\r\n    }\r\n\r\n    @action.bound\r\n    private handleClose() {\r\n        this.props.state.errorMessage = '';\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, IconButton, LinearProgress,\r\n    Menu, MenuItem, TextField\r\n} from '@material-ui/core';\r\n\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { MainMenuState } from '../states/MainMenuState';\r\n\r\n// Main Menu view\r\n@observer\r\nexport class MainMenu extends React.Component<{ state: MainMenuState }> {\r\n\r\n    componentDidMount() {\r\n        // Querying the backend for connection info and displaying it in window title\r\n        this.props.state.setWindowTitle();\r\n    }\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <div>\r\n\r\n                <IconButton color=\"inherit\"\r\n                    onClick={evt => state.menuAnchorElement = evt.currentTarget}\r\n                >\r\n                    <MenuIcon/>\r\n                </IconButton>\r\n\r\n                <Menu\r\n                    anchorEl={state.menuAnchorElement}\r\n                    keepMounted\r\n                    open={!!state.menuAnchorElement}\r\n                    onClose={() => state.menuAnchorElement = undefined}\r\n                >\r\n                    <MenuItem onClick={() => state.showConnectionParamsDialog()}>Manage Storage Connection Settings...</MenuItem>\r\n                    <MenuItem onClick={() => state.showPurgeHistoryDialog()}>Purge Instance History...</MenuItem>\r\n                    <MenuItem onClick={() => state.showCleanEntityStorageDialog()}>Clean Entity Storage...</MenuItem>\r\n                </Menu>\r\n\r\n                <Dialog\r\n                    open={state.connectionParamsDialogOpen}\r\n                    onClose={() => state.connectionParamsDialogOpen = false}\r\n                >\r\n                    <DialogTitle>Manage Storage Connection Settings</DialogTitle>\r\n                    <DialogContent>\r\n\r\n                        {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n                        \r\n                        <DialogContentText>\r\n                            {\r\n                                state.isReadonly ?\r\n                                    \"Change the below values via your application settings ('DFM_HUB_NAME' and 'AzureWebJobsStorage' respectively)\" :\r\n                                    \"The below values will be saved to local.settings.json file.\"\r\n                            }\r\n                        </DialogContentText>\r\n\r\n                        <TextField\r\n                            autoFocus\r\n                            margin=\"dense\"\r\n                            label=\"Hub Name\"\r\n                            fullWidth\r\n                            disabled={state.inProgress }\r\n                            InputProps={{ readOnly: state.isReadonly }}\r\n                            InputLabelProps={{ shrink: true }}\r\n                            value={state.hubName}\r\n                            onChange={(evt) => state.hubName = evt.target.value as string}\r\n                        />\r\n\r\n                        <TextField\r\n                            autoFocus\r\n                            margin=\"dense\"\r\n                            label=\"Azure Storage Connection String\"\r\n                            fullWidth\r\n                            disabled={state.inProgress }\r\n                            InputProps={{ readOnly: state.isReadonly }}\r\n                            InputLabelProps={{ shrink: true }}\r\n                            value={state.connectionString}\r\n                            onChange={(evt) => state.connectionString = evt.target.value as string}\r\n                        />\r\n\r\n                        <ErrorMessage state={state}/>\r\n\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={() => state.connectionParamsDialogOpen = false} color=\"primary\">\r\n                            Cancel\r\n                        </Button>\r\n\r\n                        {(!state.isReadonly) && (\r\n                            <Button\r\n                                onClick={() => state.saveConnectionParams()}\r\n                                disabled={!state.isDirty || !state.hubName || !state.connectionString || state.inProgress}\r\n                                color=\"secondary\"\r\n                            >\r\n                                Save\r\n                            </Button>\r\n                        )}\r\n\r\n                    </DialogActions>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n}","import moment from 'moment';\r\n\r\nexport class DateTimeHelpers\r\n{\r\n    public static momentAsUtc(t: moment.Moment): moment.Moment {\r\n        \r\n        if (!t || !t.isValid()) {\r\n            return t;\r\n        }\r\n\r\n        // Need to convert to UTC, because @material-ui/pickers always give us local moments\r\n        const result = moment(t.toISOString(true).slice(0, 19) + 'Z');\r\n        result.utc();\r\n        return result;\r\n    }\r\n\r\n    // This is the default range for @material-ui/pickers\r\n    private static MinMoment = moment('1900-01-01').utc();\r\n    private static MaxMoment = moment('2100-01-01').utc();\r\n\r\n    public static isValidMoment(t: moment.Moment): boolean {\r\n        return !!t && t.isValid() && t.isAfter(DateTimeHelpers.MinMoment) && t.isBefore(DateTimeHelpers.MaxMoment);\r\n    }\r\n\r\n    public static formatDateTime(dt: Date) {\r\n        return dt.toISOString().slice(0, 16);\r\n    }\r\n}","\r\n// A DTO used by DurableOrchestrationStatus.historyEvents\r\nexport class HistoryEvent {\r\n    Timestamp: string;\r\n    EventType: string;\r\n    Name: string;\r\n    FunctionName: string;\r\n    ScheduledTime: string;\r\n    SubOrchestrationId: string;\r\n    Result: any;\r\n    Details: any;\r\n}\r\n\r\n// Could instead just iterate through field names of HistoryEvent, but reflection in TypeScript still looks tricky\r\nexport const HistoryEventFields = [\r\n    'Timestamp',\r\n    'EventType',\r\n    'Name',\r\n    'ScheduledTime',\r\n    'Result',\r\n    'Details',\r\n];\r\n\r\nexport type RuntimeStatus = \"Running\" | \"Completed\" | \"ContinuedAsNew\" | \"Failed\" | \"Canceled\" | \"Terminated\" | \"Pending\";\r\n\r\nexport type EntityType = \"Orchestration\" | \"DurableEntity\";\r\n\r\nexport class EntityId {\r\n    name: string;\r\n    key: string;\r\n}\r\n\r\n// A DTO returned by DurableOrchestrationClient.getStatusAll()\r\nexport class DurableOrchestrationStatus {\r\n    instanceId: string;\r\n    name: string;\r\n    entityId: EntityId;\r\n    runtimeStatus: RuntimeStatus;\r\n    entityType: EntityType;\r\n    lastEvent: string;\r\n    input: any;\r\n    customStatus: string;\r\n    output: any;\r\n    createdTime: string;\r\n    lastUpdatedTime: string;\r\n    historyEvents?: HistoryEvent[];\r\n    tabTemplateNames?: string[];\r\n}\r\n\r\n// Could instead just iterate through field names of DurableOrchestrationStatus, but reflection in TypeScript still looks tricky\r\nexport const DurableOrchestrationStatusFields = [\r\n    'instanceId',\r\n    'name',\r\n    'createdTime',\r\n    'lastUpdatedTime',\r\n    'runtimeStatus',\r\n    'lastEvent',\r\n    'input',\r\n    'output',\r\n    'customStatus'\r\n];","import { observable, computed } from 'mobx'\r\nimport moment from 'moment';\r\n\r\nimport { DateTimeHelpers } from '../DateTimeHelpers';\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { ITypedLocalStorage } from './ITypedLocalStorage';\r\n\r\nexport enum FilterOperatorEnum {\r\n    Equals = 0,\r\n    StartsWith,\r\n    Contains\r\n}\r\n\r\nexport enum ShowEntityTypeEnum {\r\n    ShowBoth = 0,\r\n    OrchestrationsOnly,\r\n    DurableEntitiesOnly\r\n}\r\n\r\n// State of Orchestrations view\r\nexport class OrchestrationsState extends ErrorMessageState {\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; }\r\n\r\n    @computed\r\n    get orchestrations(): DurableOrchestrationStatus[] { return this._orchestrations; }\r\n\r\n    @computed\r\n    get autoRefresh(): number { return this._autoRefresh; }\r\n    set autoRefresh(val: number) {\r\n        this._autoRefresh = val;\r\n        this._localStorage.setItem('autoRefresh', this._autoRefresh.toString());\r\n        this.loadOrchestrations(true);\r\n    }\r\n\r\n    @computed\r\n    get timeFrom(): moment.Moment { return this._timeFrom; }\r\n    set timeFrom(val: moment.Moment) {\r\n        this._timeFrom = val;\r\n        this.resetOrderBy();\r\n    }\r\n\r\n    @computed\r\n    get timeTill(): moment.Moment { return (!this._timeTill) ? moment().utc() : this._timeTill; }\r\n    set timeTill(val: moment.Moment) {\r\n        this._timeTill = val;\r\n        this.resetOrderBy();\r\n    }\r\n    \r\n    @computed\r\n    get timeTillEnabled(): boolean { return !!this._timeTill; }\r\n    set timeTillEnabled(val: boolean) {\r\n\r\n        this._timeTill = val ? moment().utc() : null;\r\n\r\n        if (!val) {\r\n            this.resetOrderBy();\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n    \r\n    @computed\r\n    get orderByDirection(): ('asc' | 'desc') { return this._orderByDirection;}\r\n\r\n    @computed\r\n    get orderBy() : string { return this._orderBy; }\r\n    set orderBy(val: string) {\r\n\r\n        if (this._orderBy !== val)  {\r\n            this._orderBy = val;\r\n        }\r\n        else {\r\n            this._orderByDirection = (this._orderByDirection === 'desc') ? 'asc' : 'desc';\r\n        }\r\n\r\n        this.reloadOrchestrations();\r\n    }\r\n\r\n    @computed\r\n    get filterValue(): string { return this._filterValue; }\r\n    set filterValue(val: string) { this._filterValue = val; }\r\n\r\n    @computed\r\n    get filterOperator(): FilterOperatorEnum { return this._filterOperator; }\r\n    set filterOperator(val: FilterOperatorEnum) {\r\n        \r\n        this._filterOperator = val;\r\n\r\n        if (!!this._filterValue && this._filteredColumn !== '0') {\r\n\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    @computed\r\n    get filteredColumn(): string { return this._filteredColumn; }\r\n    set filteredColumn(val: string) {\r\n\r\n        this._filteredColumn = val;\r\n\r\n        if (!this._filterValue) {\r\n            return;\r\n        }\r\n\r\n        if (this._filteredColumn === '0') {\r\n            this._filterValue = '';\r\n        }\r\n\r\n        this.reloadOrchestrations();\r\n    }\r\n\r\n    @computed\r\n    get showEntityType(): string { return ShowEntityTypeEnum[this._showEntityType]; }\r\n    set showEntityType(val: string) {\r\n\r\n        this._showEntityType = ShowEntityTypeEnum[val];\r\n\r\n        this.reloadOrchestrations();\r\n    }\r\n\r\n    @computed\r\n    get showLastEventColumn(): boolean {\r\n        // Only showing lastEvent field when being filtered by it (because otherwise it is not populated on the server)\r\n        return this._filteredColumn === 'lastEvent' && (!!this._oldFilterValue);\r\n    }\r\n    \r\n    get backendClient(): IBackendClient { return this._backendClient; }\r\n\r\n    constructor(private _backendClient: IBackendClient, private _localStorage: ITypedLocalStorage<OrchestrationsState>) {\r\n        super();\r\n        \r\n        var momentFrom: moment.Moment;\r\n        const timeFromString = this._localStorage.getItem('timeFrom');\r\n        if (!!timeFromString) {\r\n            momentFrom = moment(timeFromString);\r\n        } else {\r\n            // By default setting it to 24 hours ago\r\n            momentFrom = moment().subtract(1, 'days');\r\n        }\r\n        momentFrom.utc();\r\n\r\n        this._timeFrom = momentFrom;\r\n        this._oldTimeFrom = momentFrom;\r\n       \r\n        const timeTillString = this._localStorage.getItem('timeTill');\r\n        if (!!timeTillString) {\r\n            this._timeTill = moment(timeTillString);\r\n            this._timeTill.utc();\r\n            this._oldTimeTill = this._timeTill;\r\n        }\r\n\r\n        const filteredColumnString = this._localStorage.getItem('filteredColumn');\r\n        if (!!filteredColumnString) {\r\n            this._filteredColumn = filteredColumnString;\r\n        }\r\n\r\n        const filterOperatorString = this._localStorage.getItem('filterOperator');\r\n        if (!!filterOperatorString) {\r\n            this._filterOperator = FilterOperatorEnum[filterOperatorString];\r\n        }\r\n\r\n        const filterValueString = this._localStorage.getItem('filterValue');\r\n        if (!!filterValueString) {\r\n            this._filterValue = filterValueString;\r\n            this._oldFilterValue = filterValueString;\r\n        }\r\n\r\n        const showEntityTypeString = this._localStorage.getItem('showEntityType');\r\n        if (!!showEntityTypeString) {\r\n            this._showEntityType = ShowEntityTypeEnum[showEntityTypeString];\r\n        }\r\n\r\n        const autoRefreshString = this._localStorage.getItem('autoRefresh');\r\n        if (!!autoRefreshString) {\r\n            this._autoRefresh = Number(autoRefreshString);\r\n        }\r\n\r\n        const orderByString = this._localStorage.getItem('orderBy');\r\n        if (!!orderByString) {\r\n            this._orderBy = orderByString;\r\n        }\r\n\r\n        const orderByDirectionString = this._localStorage.getItem('orderByDirection');\r\n        if (!!orderByDirectionString) {\r\n            this._orderByDirection = orderByDirectionString as 'asc' | 'desc';\r\n        }\r\n    }\r\n\r\n    applyTimeFrom() {\r\n        if (DateTimeHelpers.isValidMoment(this._timeFrom) && this._oldTimeFrom !== this._timeFrom) {\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    applyTimeTill() {\r\n        if (DateTimeHelpers.isValidMoment(this._timeTill) && this._oldTimeTill !== this._timeTill) {\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    applyFilterValue() {\r\n        if (this._oldFilterValue !== this._filterValue) {\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    reloadOrchestrations() {\r\n        this._orchestrations = [];\r\n        this._noMorePagesToLoad = false;\r\n\r\n        // If dates are invalid, reverting them to previous valid values\r\n        if (!DateTimeHelpers.isValidMoment(this._timeFrom)) {\r\n            this._timeFrom = this._oldTimeFrom;\r\n        }\r\n        if (!!this._timeTill && !DateTimeHelpers.isValidMoment(this._timeTill)) {\r\n            this._timeTill = this._oldTimeTill;\r\n        }\r\n\r\n        // persisting state as a batch\r\n        this._localStorage.setItems([\r\n            { fieldName: 'timeFrom', value: this._timeFrom.toISOString() },\r\n            { fieldName: 'timeTill', value: !!this._timeTill ? this._timeTill.toISOString() : null },\r\n            { fieldName: 'filteredColumn', value: this._filteredColumn },\r\n            { fieldName: 'filterOperator', value: FilterOperatorEnum[this._filterOperator] },\r\n            { fieldName: 'filterValue', value: !!this._filterValue ? this._filterValue : null },\r\n            { fieldName: 'showEntityType', value: ShowEntityTypeEnum[this._showEntityType] },\r\n            { fieldName: 'orderBy', value: this._orderBy },\r\n            { fieldName: 'orderByDirection', value: this._orderByDirection },\r\n        ]);\r\n\r\n        this.loadOrchestrations();\r\n\r\n        this._oldFilterValue = this._filterValue;\r\n        this._oldTimeFrom = this._timeFrom;\r\n        this._oldTimeTill = this._timeTill;\r\n    }\r\n\r\n    loadOrchestrations(isAutoRefresh: boolean = false) {\r\n\r\n        if (!!this.inProgress || (!!this._noMorePagesToLoad && !this._autoRefresh )) {\r\n            return;            \r\n        }\r\n        this._inProgress = true;\r\n        \r\n        const timeFrom = this._timeFrom.toISOString();\r\n        const timeTill = !!this._timeTill ? this._timeTill.toISOString() : moment().utc().toISOString();\r\n        var filterClause = `&$filter=createdTime ge '${timeFrom}' and createdTime le '${timeTill}'`;\r\n\r\n        if (this._showEntityType === ShowEntityTypeEnum.OrchestrationsOnly) {\r\n            filterClause += ` and entityType eq 'Orchestration'`;\r\n        }\r\n        else if (this._showEntityType === ShowEntityTypeEnum.DurableEntitiesOnly) {\r\n            filterClause += ` and entityType eq 'DurableEntity'`;\r\n        }\r\n        \r\n        if (!!this._filterValue && this._filteredColumn !== '0') {\r\n\r\n            filterClause += ' and ';\r\n\r\n            switch (this._filterOperator) {\r\n                case FilterOperatorEnum.Equals:\r\n                    filterClause += `${this._filteredColumn} eq '${this._filterValue}'`;\r\n                break;\r\n                case FilterOperatorEnum.StartsWith:\r\n                    filterClause += `startswith(${this._filteredColumn}, '${this._filterValue}')`;\r\n                break;\r\n                case FilterOperatorEnum.Contains:\r\n                    filterClause += `contains(${this._filteredColumn}, '${this._filterValue}')`;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // In auto-refresh mode only refreshing the first page\r\n        const skip = isAutoRefresh ? 0 : this._orchestrations.length;\r\n\r\n        const orderByClause = !!this._orderBy ? `&$orderby=${this._orderBy} ${this.orderByDirection}` : '';\r\n        const uri = `/orchestrations?$top=${this._pageSize}&$skip=${skip}${filterClause}${orderByClause}`;\r\n\r\n        this._backendClient.call('GET', uri).then(response => {\r\n\r\n            if (!response.length) {\r\n                // Stop the infinite scrolling\r\n                this._noMorePagesToLoad = true;\r\n            } else {\r\n                if (isAutoRefresh) {\r\n                    this._orchestrations = response;\r\n                } else {\r\n                    this._orchestrations.push(...response);\r\n                }\r\n            }\r\n\r\n            // Doing auto-refresh\r\n            if (!!this._autoRefresh) {\r\n\r\n                if (!!this._autoRefreshToken) {\r\n                    clearTimeout(this._autoRefreshToken);\r\n                }\r\n                this._autoRefreshToken = setTimeout(() => this.loadOrchestrations(true), this._autoRefresh * 1000);\r\n            }\r\n\r\n        }, err => {\r\n\r\n            // Cancelling auto-refresh just in case\r\n            this._autoRefresh = 0;\r\n\r\n            this.errorMessage = `Load failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _inProgress: boolean = false;\r\n    @observable\r\n    private _orchestrations: DurableOrchestrationStatus[] = [];\r\n    @observable\r\n    private _orderByDirection: ('asc' | 'desc') = 'asc';\r\n    @observable\r\n    private _orderBy: string = '';\r\n    @observable\r\n    private _autoRefresh: number = 0;\r\n\r\n    @observable\r\n    private _timeFrom: moment.Moment;\r\n    @observable\r\n    private _timeTill: moment.Moment;\r\n\r\n    @observable\r\n    private _filterValue: string = '';\r\n    @observable\r\n    private _filterOperator: FilterOperatorEnum = FilterOperatorEnum.Equals;\r\n    @observable\r\n    private _filteredColumn: string = '0';\r\n    @observable\r\n    private _showEntityType: ShowEntityTypeEnum = ShowEntityTypeEnum.ShowBoth;\r\n\r\n    private _noMorePagesToLoad: boolean = false;\r\n    private readonly _pageSize = 50;\r\n    private _autoRefreshToken: NodeJS.Timeout;\r\n    private _oldFilterValue: string = '';\r\n\r\n    private _oldTimeFrom: moment.Moment;\r\n    private _oldTimeTill: moment.Moment;\r\n\r\n    private resetOrderBy() {\r\n        this._orderBy = '';\r\n        this._orderByDirection = 'asc';\r\n    }\r\n}","import * as React from 'react';\r\nimport { action } from 'mobx'\r\nimport { observer } from 'mobx-react';\r\n\r\nimport { Link } from '@material-ui/core';\r\n\r\nimport { IBackendClient } from '../services/IBackendClient';\r\n\r\n// Renders a link to be opened either in a new browser tab or in a new VsCode WebView\r\n@observer\r\nexport class OrchestrationLink extends React.Component<{ orchestrationId: string, title?: string, backendClient: IBackendClient }> {\r\n\r\n    render(): JSX.Element {\r\n\r\n        if (this.props.backendClient.isVsCode) {\r\n\r\n            return (\r\n                <Link href=\"#\" onClick={this.onLinkClicked} >\r\n                    {this.props.title ?? this.props.orchestrationId}\r\n                </Link>\r\n            );            \r\n        } else {\r\n\r\n            return (\r\n                <Link href={`/orchestrations/${this.extraSanitizeHrefComponent(this.props.orchestrationId)}`} target=\"_blank\">\r\n                    {this.props.title ?? this.props.orchestrationId}\r\n                </Link>\r\n            );\r\n        }\r\n    }\r\n\r\n    @action.bound\r\n    private onLinkClicked() {\r\n        this.props.backendClient.call('OpenInNewWindow', this.props.orchestrationId);\r\n    }\r\n\r\n    // Just to be extra sure\r\n    private extraSanitizeHrefComponent(s: string): string{\r\n        return s.replace(/javascript:/gi, '');\r\n    }\r\n}","import { observable } from 'mobx'\r\n\r\n// State of Error Message snackbar\r\nexport class ErrorMessageState {\r\n\r\n    @observable\r\n    errorMessage: string = '';\r\n}","import * as React from 'react';\r\nimport { action } from 'mobx'\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Button, Checkbox, FormControl, FormControlLabel, FormHelperText, Grid, InputBase, InputLabel,\r\n    LinearProgress, MenuItem, Select,\r\n    Table, TableBody, TableCell, TableHead, TableRow, TableSortLabel, TextField, Toolbar, Typography, Radio, RadioGroup\r\n} from '@material-ui/core';\r\n\r\nimport { KeyboardDateTimePicker } from '@material-ui/pickers';\r\n\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\n\r\nimport './Orchestrations.css';\r\n\r\nimport { DateTimeHelpers } from '../DateTimeHelpers';\r\nimport { DurableOrchestrationStatusFields } from '../states/DurableOrchestrationStatus';\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { OrchestrationLink } from './OrchestrationLink';\r\nimport { OrchestrationsState, ShowEntityTypeEnum } from '../states/OrchestrationsState';\r\n\r\n// Orchestrations view\r\n@observer\r\nexport class Orchestrations extends React.Component<{ state: OrchestrationsState }> {\r\n\r\n    componentDidMount() {\r\n\r\n        // Triggering initial load\r\n        this.props.state.loadOrchestrations();\r\n\r\n        // Doing a simple infinite scroll\r\n        document.addEventListener('scroll', (evt) => {\r\n\r\n            const scrollingElement = (evt.target as Document).scrollingElement;\r\n            if (!scrollingElement) { \r\n                return;\r\n            }\r\n\r\n            const scrollPos = scrollingElement.scrollHeight - window.innerHeight - scrollingElement.scrollTop;\r\n            const scrollPosThreshold = 100;\r\n\r\n            if (scrollPos < scrollPosThreshold) {\r\n                this.props.state.loadOrchestrations();\r\n            }\r\n        });\r\n    }\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n            \r\n            {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n\r\n            <Toolbar variant=\"dense\" className=\"top-toolbar\">\r\n\r\n                <Grid container className=\"toolbar-grid1\">\r\n                    <Grid item xs={12}>\r\n\r\n                        <KeyboardDateTimePicker\r\n                            className=\"from-input\"\r\n                            style={{ marginLeft: 10 }}\r\n                            ampm={false}\r\n                            autoOk={true}\r\n                            label=\"From &nbsp;&nbsp; (UTC)\"\r\n                            invalidDateMessage=\"\"\r\n                            format={\"YYYY-MM-DD HH:mm:ss\"}\r\n                            disabled={state.inProgress}\r\n                            value={state.timeFrom}\r\n                            onChange={(t) => state.timeFrom = DateTimeHelpers.momentAsUtc(t)}\r\n                            onBlur={() => state.applyTimeFrom()}\r\n                            onAccept={() => state.applyTimeFrom()}\r\n                            onKeyPress={this.handleKeyPress}\r\n                        />\r\n\r\n                    </Grid>\r\n                    <Grid item xs={12} className=\"toolbar-grid1-item2\">\r\n                        <FormControl>\r\n                            <InputLabel className=\"till-label\" htmlFor=\"till-checkbox\" shrink >Till</InputLabel>\r\n                            <Checkbox\r\n                                id=\"till-checkbox\"\r\n                                className=\"till-checkbox\"\r\n                                disabled={state.inProgress}\r\n                                checked={state.timeTillEnabled}\r\n                                onChange={(evt) => state.timeTillEnabled = evt.target.checked}\r\n                            />\r\n                        </FormControl>\r\n\r\n                        {state.timeTillEnabled ? (\r\n                            <KeyboardDateTimePicker\r\n                                className=\"till-input\"\r\n                                ampm={false}\r\n                                autoOk={true}\r\n                                label=\"(UTC)\"\r\n                                invalidDateMessage=\"\"\r\n                                format={\"YYYY-MM-DD HH:mm:ss\"}\r\n                                disabled={state.inProgress}\r\n                                value={state.timeTill}\r\n                                onChange={(t) => state.timeTill = DateTimeHelpers.momentAsUtc(t)}\r\n                                onBlur={() => state.applyTimeTill()}\r\n                                onAccept={() => state.applyTimeTill()}\r\n                                onKeyPress={this.handleKeyPress}\r\n                            />\r\n                        ) : (\r\n                            <TextField\r\n                                className=\"till-input\"\r\n                                label=\"(UTC)\"\r\n                                placeholder=\"[Now]\"\r\n                                InputLabelProps={{ shrink: true }}\r\n                                type=\"text\"\r\n                                disabled={true}\r\n                            />\r\n                        )}                        \r\n                        \r\n                    </Grid>\r\n                </Grid>\r\n\r\n                <Grid container className=\"toolbar-grid2\">\r\n                    <Grid item xs={12}>\r\n                        <FormControl>\r\n                            <InputLabel htmlFor=\"filtered-column-select\">Filtered Column</InputLabel>\r\n                            <Select\r\n                                className=\"toolbar-select filtered-column-input\"\r\n                                disabled={state.inProgress}\r\n                                value={state.filteredColumn}\r\n                                onChange={(evt) => state.filteredColumn = evt.target.value as string}\r\n                                inputProps={{ id: \"filtered-column-select\" }}>\r\n\r\n                                <MenuItem value=\"0\">[Not Selected]</MenuItem>\r\n                                {DurableOrchestrationStatusFields.map(col => {\r\n                                    return (<MenuItem key={col} value={col}>{col}</MenuItem>);\r\n                                })}\r\n\r\n                            </Select>\r\n                        </FormControl>\r\n                        <FormControl className=\"toolbar-grid2-item1-select\">\r\n                            <InputLabel htmlFor=\"filter-operator-select\">Filter Operator</InputLabel>\r\n                            <Select\r\n                                className=\"toolbar-select\"\r\n                                disabled={state.inProgress}\r\n                                value={state.filterOperator}\r\n                                onChange={(evt) => state.filterOperator = evt.target.value as number}\r\n                                inputProps={{ id: \"filter-operator-select\" }}>\r\n                                <MenuItem value={0}>Equals</MenuItem>\r\n                                <MenuItem value={1}>Starts With</MenuItem>\r\n                                <MenuItem value={2}>Contains</MenuItem>\r\n                            </Select>\r\n                        </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={12} className=\"toolbar-grid2-item2\">\r\n                        <TextField\r\n                            className=\"filter-value-input\"\r\n                            label=\"Filter Value\"\r\n                            InputLabelProps={{ shrink: true }}\r\n                            placeholder=\"[some text or 'null']\"\r\n                            disabled={state.filteredColumn === '0' || state.inProgress}\r\n                            value={state.filterValue}\r\n                            onChange={(evt) => state.filterValue = evt.target.value as string}\r\n                            onBlur={() => state.applyFilterValue()}\r\n                            onKeyPress={this.handleKeyPress}\r\n                        />\r\n                    </Grid>\r\n                </Grid>\r\n\r\n                <RadioGroup\r\n                    value={state.showEntityType}\r\n                    onChange={(evt) => state.showEntityType = (evt.target as HTMLInputElement).value}\r\n                >\r\n                    <FormControlLabel                            \r\n                        className=\"entity-type-radio\"\r\n                        disabled={state.inProgress}\r\n                        value={ShowEntityTypeEnum[ShowEntityTypeEnum.ShowBoth]}\r\n                        control={<Radio />}\r\n                        label={<Typography variant=\"subtitle2\">Show both</Typography>}\r\n                    />\r\n                    <FormControlLabel\r\n                        className=\"entity-type-radio\"\r\n                        disabled={state.inProgress}\r\n                        value={ShowEntityTypeEnum[ShowEntityTypeEnum.OrchestrationsOnly]}\r\n                        control={<Radio />}\r\n                        label={<Typography variant=\"subtitle2\">Orchestrations only</Typography>}\r\n                    />\r\n                    <FormControlLabel\r\n                        className=\"entity-type-radio\"\r\n                        disabled={state.inProgress}\r\n                        value={ShowEntityTypeEnum[ShowEntityTypeEnum.DurableEntitiesOnly]}\r\n                        control={<Radio />}\r\n                        label={<Typography variant=\"subtitle2\">Durable Entities only</Typography>}\r\n                    />\r\n                </RadioGroup>\r\n\r\n                <Typography style={{ flex: 1 }} />\r\n\r\n                <Grid container className=\"toolbar-grid3\">\r\n                    <Grid item xs={12}>\r\n                        <FormControl className=\"form-control-float-right\">\r\n                            <InputLabel htmlFor=\"auto-refresh-select\">Auto-refresh</InputLabel>\r\n                            <Select\r\n                                className=\"toolbar-select\"\r\n                                inputProps={{ id: \"auto-refresh-select\" }}\r\n                                value={state.autoRefresh}\r\n                                onChange={(evt) => state.autoRefresh = evt.target.value as number}\r\n                            >\r\n                                <MenuItem value={0}>Never</MenuItem>\r\n                                <MenuItem value={1}>Every 1 sec.</MenuItem>\r\n                                <MenuItem value={5}>Every 5 sec.</MenuItem>\r\n                                <MenuItem value={10}>Every 10 sec.</MenuItem>\r\n                            </Select>\r\n                        </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={12} className=\"toolbar-grid3-item2\">\r\n                        <Button\r\n                            className=\"refresh-button form-control-float-right\"\r\n                            variant=\"outlined\"\r\n                            color=\"default\"\r\n                            size=\"large\"\r\n                            onClick={() => state.reloadOrchestrations()}\r\n                        >\r\n                            <RefreshIcon />\r\n                        </Button>\r\n                    </Grid>\r\n                </Grid>\r\n\r\n            </Toolbar>\r\n\r\n            <FormHelperText className=\"items-count-label\">\r\n                {!!state.orchestrations.length ? `${state.orchestrations.length} items shown`: ''}\r\n            </FormHelperText>\r\n\r\n            {!!state.orchestrations.length ? this.renderTable(state) : this.renderEmptyTable()}\r\n\r\n            {state.inProgress && !!state.orchestrations.length ? (<LinearProgress />) : (<Box height={4} />)}\r\n            <Toolbar variant=\"dense\" />\r\n            \r\n            <ErrorMessage state={this.props.state} />\r\n            \r\n        </>);\r\n    }\r\n\r\n    private renderEmptyTable(): JSX.Element {\r\n        return (\r\n            <Typography variant=\"h5\" className=\"empty-table-placeholder\" >\r\n                This list is empty\r\n            </Typography>\r\n        );\r\n    }\r\n\r\n    private renderTable(state: OrchestrationsState): JSX.Element {\r\n\r\n        return (\r\n            <Table size=\"small\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        {DurableOrchestrationStatusFields\r\n                            // hiding artificial 'lastEvent' column, when not used\r\n                            .filter(f => state.showLastEventColumn ? true : f !== 'lastEvent')\r\n                            .map(col => {\r\n                                return (\r\n                                    <TableCell key={col}>\r\n                                        <TableSortLabel\r\n                                            active={state.orderBy === col}\r\n                                            direction={state.orderByDirection}\r\n                                            onClick={() => state.orderBy = col}\r\n                                        >\r\n                                            {col}\r\n                                        </TableSortLabel>\r\n                                    </TableCell>\r\n                                );\r\n                            })\r\n                        }\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {state.orchestrations.map(orchestration => {\r\n\r\n                        const cellStyle = { verticalAlign: 'top' };\r\n                        return (\r\n                            <TableRow\r\n                                key={orchestration.instanceId}\r\n                                className={\"runtime-status-\" + orchestration.runtimeStatus.toString().toLowerCase()}\r\n                            >\r\n                                <TableCell className=\"instance-id-cell\" style={cellStyle}>\r\n                                    <OrchestrationLink orchestrationId={orchestration.instanceId} backendClient={state.backendClient}/>\r\n                                </TableCell>\r\n                                <TableCell className=\"name-cell\" style={cellStyle}>\r\n                                    {orchestration.name}\r\n                                </TableCell>\r\n                                <TableCell className=\"datetime-cell\" style={cellStyle}>\r\n                                    {orchestration.createdTime}\r\n                                </TableCell>\r\n                                <TableCell className=\"datetime-cell\" style={cellStyle}>\r\n                                    {orchestration.lastUpdatedTime}\r\n                                </TableCell>\r\n                                <TableCell style={cellStyle}>\r\n                                    {orchestration.runtimeStatus}\r\n                                </TableCell>\r\n                                {state.showLastEventColumn && (<TableCell style={cellStyle}>\r\n                                    {orchestration.lastEvent}\r\n                                </TableCell>)}\r\n                                <TableCell className=\"long-text-cell\" style={cellStyle}>\r\n                                    <InputBase\r\n                                        className=\"long-text-cell-input\"\r\n                                        multiline fullWidth rowsMax={5} readOnly\r\n                                        value={JSON.stringify(orchestration.input)}\r\n                                    />\r\n                                </TableCell>\r\n                                <TableCell className=\"output-cell\" style={cellStyle}>\r\n                                    <InputBase\r\n                                        className=\"long-text-cell-input\"\r\n                                        multiline fullWidth rowsMax={5} readOnly\r\n                                        value={JSON.stringify(orchestration.output)}\r\n                                    />\r\n                                </TableCell>\r\n                                <TableCell className=\"output-cell\" style={cellStyle}>\r\n                                    <InputBase\r\n                                        className=\"long-text-cell-input\"\r\n                                        multiline fullWidth rowsMax={5} readOnly\r\n                                        value={JSON.stringify(orchestration.customStatus)}\r\n                                    />\r\n                                </TableCell>\r\n                            </TableRow>\r\n                        );\r\n                    })}\r\n                </TableBody>\r\n            </Table>\r\n        );\r\n    }\r\n\r\n    @action.bound\r\n    private handleKeyPress(event: React.KeyboardEvent<HTMLInputElement>) {\r\n        if (event.key === 'Enter') {\r\n            // Otherwise the event will bubble up and the form will be submitted\r\n            event.preventDefault();\r\n\r\n            this.props.state.reloadOrchestrations();\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle,\r\n} from '@material-ui/core';\r\n\r\nimport { OrchestrationDetailsState } from '../states/OrchestrationDetailsState';\r\n\r\n// Buttons for detailed durable entity view\r\n@observer\r\nexport class DurableEntityButtons extends React.Component<{ state: OrchestrationDetailsState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n\r\n            {this.renderDialogs(state)}\r\n\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"large\" onClick={() => state.purgeConfirmationOpen = true}>\r\n                Purge\r\n            </Button>            \r\n        </>);\r\n    }\r\n\r\n    private renderDialogs(state: OrchestrationDetailsState): JSX.Element {\r\n        return (<>\r\n\r\n            <Dialog\r\n                open={state.purgeConfirmationOpen}\r\n                onClose={() => state.purgeConfirmationOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Purge</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to purge entity '{state.orchestrationId}'. This operation drops entity state from the underlying storage and cannot be undone. Are you sure?\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.purgeConfirmationOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.purge()} color=\"secondary\">\r\n                        Yes, purge\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n        </>);\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Grid, TextField\r\n} from '@material-ui/core';\r\n\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\n\r\n// Fields for detailed durable entity view\r\n@observer\r\nexport class DurableEntityFields extends React.Component<{ details: DurableOrchestrationStatus }> {\r\n\r\n    render(): JSX.Element {\r\n        const details = this.props.details;\r\n\r\n        return (<>\r\n            <Grid container className=\"grid-container\">\r\n                <Grid item xs={12} sm={12} md={3} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"entityId.name\"\r\n                        value={details.entityId.name}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n\r\n                <Grid item xs={12} sm={6} md={3} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"entityId.key\"\r\n                        value={details.entityId.key}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"createdTime\"\r\n                        value={details.createdTime}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"lastUpdatedTime\"\r\n                        value={details.lastUpdatedTime}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"runtimeStatus\"\r\n                        value={details.runtimeStatus}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        className={!!details.runtimeStatus ? \"runtime-status-\" + details.runtimeStatus.toLowerCase() : \"\"}\r\n                    />\r\n                </Grid>\r\n                \r\n                <Grid item xs={12} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"input\"\r\n                        value={JSON.stringify(details.input, null, 3)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        multiline\r\n                        rowsMax={10}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"customStatus\"\r\n                        value={JSON.stringify(details.customStatus, null, 3)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        multiline\r\n                        rowsMax={10}\r\n                    />\r\n                </Grid>\r\n            </Grid>\r\n\r\n        </>);\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, TextField\r\n} from '@material-ui/core';\r\n\r\nimport { OrchestrationDetailsState } from '../states/OrchestrationDetailsState';\r\n\r\n// Buttons for detailed orchestration view\r\n@observer\r\nexport class OrchestrationButtons extends React.Component<{ state: OrchestrationDetailsState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n\r\n            {this.renderDialogs(state)}\r\n\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" onClick={() => state.rewindConfirmationOpen = true}>\r\n                Rewind\r\n                </Button>\r\n            <Box width={20} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" onClick={() => state.terminateConfirmationOpen = true}>\r\n                Terminate\r\n            </Button>\r\n            <Box width={20} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" onClick={() => state.raiseEventDialogOpen = true}>\r\n                Raise Event\r\n            </Button>\r\n            <Box width={20} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" onClick={() => state.setCustomStatusDialogOpen = true}>\r\n                Set Custom Status\r\n            </Button>\r\n            <Box width={20} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" onClick={() => state.purgeConfirmationOpen = true}>\r\n                Purge\r\n            </Button>            \r\n            \r\n        </>);\r\n    }\r\n\r\n    private renderDialogs(state: OrchestrationDetailsState): JSX.Element {\r\n        return (<>\r\n\r\n            <Dialog\r\n                open={state.rewindConfirmationOpen}\r\n                onClose={() => state.rewindConfirmationOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Rewind</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to rewind orchestration '{state.orchestrationId}'. Are you sure?\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.rewindConfirmationOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.rewind()} color=\"secondary\">\r\n                        Yes, rewind\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n                open={state.terminateConfirmationOpen}\r\n                onClose={() => state.terminateConfirmationOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Terminate</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to terminate orchestration '{state.orchestrationId}'. This operation cannot be undone. Are you sure?\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.terminateConfirmationOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.terminate()} color=\"secondary\">\r\n                        Yes, terminate\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n                fullWidth={true}\r\n                open={state.raiseEventDialogOpen}\r\n                onClose={() => state.raiseEventDialogOpen = false}\r\n            >\r\n                <DialogTitle>Raise Event</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        Provide event name and some additional data\r\n                    </DialogContentText>\r\n\r\n                    <TextField\r\n                        autoFocus\r\n                        margin=\"dense\"\r\n                        label=\"Event Name\"\r\n                        InputLabelProps={{ shrink: true }}\r\n                        fullWidth\r\n                        value={state.eventName}\r\n                        onChange={(evt) => state.eventName = evt.target.value as string}\r\n                    />\r\n\r\n                    <TextField\r\n                        margin=\"dense\"\r\n                        label=\"Event Data (JSON)\"\r\n                        InputLabelProps={{ shrink: true }}\r\n                        fullWidth\r\n                        multiline\r\n                        rows={7}\r\n                        value={state.eventData}\r\n                        onChange={(evt) => state.eventData = evt.target.value as string}\r\n                    />\r\n\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.raiseEventDialogOpen = false} color=\"primary\">\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.raiseEvent()} disabled={!state.eventName} color=\"secondary\">\r\n                        Raise\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n            \r\n            <Dialog\r\n                fullWidth={true}\r\n                open={state.setCustomStatusDialogOpen}\r\n                onClose={() => state.setCustomStatusDialogOpen = false}\r\n            >\r\n                <DialogTitle>Set customStatus</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        customStatus field is a way for external clients to differentiate instances of your orchestration. It does not affect the orchestration workflow itself.\r\n                    </DialogContentText>\r\n\r\n                    <TextField\r\n                        margin=\"dense\"\r\n                        InputLabelProps={{ shrink: true }}\r\n                        label=\"New customStatus (JSON)\"\r\n                        fullWidth\r\n                        multiline\r\n                        rows={10}\r\n                        value={state.newCustomStatus}\r\n                        onChange={(evt) => state.newCustomStatus = evt.target.value as string}\r\n                    />\r\n\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.setCustomStatusDialogOpen = false} color=\"primary\">\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.setCustomStatus()} disabled={!state.isCustomStatusDirty} color=\"secondary\">\r\n                        Apply\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n                open={state.purgeConfirmationOpen}\r\n                onClose={() => state.purgeConfirmationOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Purge</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to purge orchestration '{state.orchestrationId}'. This operation drops orchestration state from the underlying storage and cannot be undone. Are you sure?\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.purgeConfirmationOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.purge()} color=\"secondary\">\r\n                        Yes, purge\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        </>);\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    FormHelperText, Grid, InputBase, Table, TableBody, TableCell, TableHead, TableRow, Typography, TextField\r\n} from '@material-ui/core';\r\n\r\nimport { DurableOrchestrationStatus, HistoryEventFields } from '../states/DurableOrchestrationStatus';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { OrchestrationLink } from './OrchestrationLink';\r\n\r\n// Fields for detailed orchestration view\r\n@observer\r\nexport class OrchestrationFields extends React.Component<{ details: DurableOrchestrationStatus, backendClient: IBackendClient }> {\r\n\r\n    render(): JSX.Element {\r\n        const details = this.props.details;\r\n\r\n        return (<>\r\n            <Grid container className=\"grid-container\">\r\n                <Grid item xs={12} sm={12} md={3} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"name\"\r\n                        value={details.name}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"createdTime\"\r\n                        value={details.createdTime}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"lastUpdatedTime\"\r\n                        value={details.lastUpdatedTime}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"runtimeStatus\"\r\n                        value={details.runtimeStatus}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        className={!!details.runtimeStatus ? \"runtime-status-\" + details.runtimeStatus.toLowerCase() : \"\"}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"customStatus\"\r\n                        value={JSON.stringify(details.customStatus)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"input\"\r\n                        value={JSON.stringify(details.input, null, 3)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        multiline\r\n                        rowsMax={8}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"output\"\r\n                        value={JSON.stringify(details.output, null, 3)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        multiline\r\n                        rowsMax={8}\r\n                    />\r\n                </Grid>\r\n            </Grid>\r\n\r\n            <FormHelperText className=\"history-events-count-label\">\r\n                historyEvents: {!!details.historyEvents ? details.historyEvents.length : 0} items\r\n            </FormHelperText>\r\n\r\n            {this.renderTable(details.historyEvents)}\r\n\r\n        </>);\r\n    }\r\n\r\n    private renderEmptyTable(): JSX.Element {\r\n        return (\r\n            <Typography variant=\"h5\" className=\"empty-table-placeholder\" >\r\n                This list is empty\r\n            </Typography>\r\n        );\r\n    }\r\n\r\n    private renderTable(events: Array<any> | undefined): JSX.Element {\r\n\r\n        if (!events || !events.length) {\r\n            return this.renderEmptyTable();\r\n        }\r\n\r\n        return (\r\n            <Table size=\"small\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        {HistoryEventFields.map(col => {\r\n                            return <TableCell key={col}>{col}</TableCell>;\r\n                        })}\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {events.map((event: any, index: number) => {\r\n\r\n                        const cellStyle = { verticalAlign: 'top' };\r\n                        return (\r\n                            <TableRow key={index}>\r\n                                <TableCell style={cellStyle}>\r\n                                    {event.Timestamp}\r\n                                </TableCell>\r\n                                <TableCell style={cellStyle}>\r\n                                    {event.EventType}\r\n                                </TableCell>\r\n                                <TableCell className=\"name-cell\" style={cellStyle}>\r\n\r\n                                    {!!event.SubOrchestrationId ?\r\n                                        (<OrchestrationLink\r\n                                            orchestrationId={event.SubOrchestrationId}\r\n                                            title={event.FunctionName}\r\n                                            backendClient={this.props.backendClient} />)\r\n                                        :\r\n                                        (event.Name ?? event.FunctionName)\r\n                                    }\r\n\r\n                                </TableCell>\r\n                                <TableCell style={cellStyle}>\r\n                                    {event.ScheduledTime}\r\n                                </TableCell>\r\n                                <TableCell className=\"long-text-cell\" style={cellStyle}>\r\n                                    <InputBase\r\n                                        className=\"long-text-cell-input\"\r\n                                        multiline fullWidth rowsMax={5} readOnly\r\n                                        value={JSON.stringify(event.Result)}\r\n                                    />\r\n                                </TableCell>\r\n                                <TableCell className=\"long-text-cell\" style={cellStyle}>\r\n                                    <InputBase\r\n                                        className=\"long-text-cell-input\"\r\n                                        multiline fullWidth rowsMax={5} readOnly\r\n                                        value={event.Details}\r\n                                    />\r\n                                </TableCell>\r\n                            </TableRow>\r\n                        );\r\n                    })}\r\n                </TableBody>\r\n            </Table>\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    AppBar, Box, Button, FormControl, InputLabel, LinearProgress, MenuItem, Paper,\r\n    Select, Tabs, Tab, TextField, Toolbar, Typography\r\n} from '@material-ui/core';\r\n\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\n\r\nimport './OrchestrationDetails.css';\r\n\r\nimport { DurableEntityButtons } from './DurableEntityButtons';\r\nimport { DurableEntityFields } from './DurableEntityFields';\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { OrchestrationButtons } from './OrchestrationButtons';\r\nimport { OrchestrationDetailsState } from '../states/OrchestrationDetailsState';\r\nimport { OrchestrationFields } from './OrchestrationFields';\r\n\r\n// Orchestration Details view\r\n@observer\r\nexport class OrchestrationDetails extends React.Component<{ state: OrchestrationDetailsState }> {\r\n\r\n    componentDidMount() {\r\n\r\n        // Triggering initial load\r\n        this.props.state.loadDetails();\r\n    }\r\n    \r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n            {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n           \r\n            <Toolbar variant=\"dense\" className=\"top-toolbar\">\r\n\r\n                {state.details.entityType === \"Orchestration\" && (\r\n                    <OrchestrationButtons state={state} />\r\n                )}\r\n                {state.details.entityType === \"DurableEntity\" && (\r\n                    <DurableEntityButtons state={state} />\r\n                )}\r\n                \r\n                <Box width={20} />\r\n                <Typography style={{ flex: 1 }} />\r\n\r\n                <FormControl>\r\n                    <InputLabel htmlFor=\"auto-refresh-select\">Auto-refresh</InputLabel>\r\n                    <Select\r\n                        className=\"toolbar-select\"\r\n                        value={state.autoRefresh}\r\n                        onChange={(evt) => state.autoRefresh = evt.target.value as number}\r\n                        inputProps={{ id: 'auto-refresh-select' }}>\r\n                        <MenuItem value={0}>Never</MenuItem>\r\n                        <MenuItem value={1}>Every 1 sec.</MenuItem>\r\n                        <MenuItem value={5}>Every 5 sec.</MenuItem>\r\n                        <MenuItem value={10}>Every 10 sec.</MenuItem>\r\n                    </Select>\r\n                </FormControl>\r\n\r\n                <Box width={20} />\r\n\r\n                <Button className=\"details-refresh-button\" variant=\"outlined\" color=\"default\" size=\"large\" onClick={() => state.loadDetails()}>\r\n                    <RefreshIcon />\r\n                </Button>\r\n\r\n            </Toolbar>\r\n\r\n            {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n\r\n\r\n\r\n            {!!state.tabStates.length && (<>\r\n                <AppBar color=\"inherit\" position=\"static\">\r\n                    <Tabs value={state.selectedTabIndex} onChange={(ev: React.ChangeEvent<{}>, val) => state.selectedTabIndex = val}>\r\n                        <Tab label=\"Details\" disabled={state.inProgress} />\r\n                        {state.tabStates.map(tabState => (\r\n                            <Tab label={tabState.name} disabled={state.inProgress} />\r\n                        ))}\r\n                    </Tabs>\r\n                </AppBar>\r\n            </>)}\r\n\r\n            {!state.selectedTabIndex && !state.inProgress && state.details.entityType === \"Orchestration\" &&\r\n                (<OrchestrationFields details={state.details} backendClient={state.backendClient} />)\r\n            }\r\n            {!state.selectedTabIndex && !state.inProgress && state.details.entityType === \"DurableEntity\" &&\r\n                <DurableEntityFields details={state.details} />\r\n            }\r\n\r\n            {!!state.selectedTab && !!state.selectedTab.rawHtml && (<>\r\n\r\n                <div className=\"raw-html-div\" dangerouslySetInnerHTML={{ __html: state.selectedTab.rawHtml }} />\r\n                \r\n                {state.selectedTab.name === \"Sequence Diagram\" && (\r\n\r\n                    <div className=\"sequence-diagram-code\">\r\n                        <TextField\r\n                            className=\"sequence-diagram-code\"\r\n                            label=\"mermaid sequence diagram code (for your reference)\"\r\n                            value={state.selectedTab.description}\r\n                            margin=\"normal\"\r\n                            InputProps={{ readOnly: true }}\r\n                            InputLabelProps={{ shrink: true }}\r\n                            variant=\"outlined\"\r\n                            fullWidth\r\n                            multiline\r\n                            rowsMax={4}\r\n                        />\r\n                    </div>\r\n                )}\r\n                \r\n            </>)}\r\n\r\n            <ErrorMessage state={this.props.state} />\r\n        </>);\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Checkbox, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, FormControl,\r\n    FormControlLabel, FormGroup, FormLabel, LinearProgress, Radio, RadioGroup, Tooltip, Typography\r\n} from '@material-ui/core';\r\n\r\nimport { KeyboardDateTimePicker } from '@material-ui/pickers';\r\n\r\nimport './PurgeHistoryDialog.css';\r\n\r\nimport { DateTimeHelpers } from '../DateTimeHelpers';\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { EntityType, RuntimeStatus } from '../states/DurableOrchestrationStatus';\r\nimport { PurgeHistoryDialogState } from '../states/PurgeHistoryDialogState';\r\n\r\n// Dialog with parameters for purging orchestration instance history\r\n@observer\r\nexport class PurgeHistoryDialog extends React.Component<{ state: PurgeHistoryDialogState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <Dialog open={state.dialogOpen} onClose={() => { if (!state.inProgress) state.dialogOpen = false; }}>\r\n\r\n                <DialogTitle>Purge Instance History</DialogTitle>\r\n\r\n                {state.instancesDeleted === null && (\r\n                    <div>\r\n                        <DialogContent>\r\n\r\n                            {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n\r\n                            <DialogContentText>\r\n                                WARNING: this operation drops instance states from the underlying storage and cannot be undone.\r\n\r\n                                {state.entityType === \"DurableEntity\" && (\r\n                                    <Typography color=\"error\" >\r\n                                        It might as well remove Durable Entities, that are still active.\r\n                                        Ensure that you specify the correct time frame!\r\n                                        To clean up deleted Entities use the 'Clean Entity Storage' command instead. \r\n                                    </Typography>\r\n                                )}\r\n\r\n                            </DialogContentText>\r\n\r\n                            <FormControl className=\"purge-history-statuses\" disabled={state.inProgress} fullWidth>\r\n                                <FormLabel>Apply to:</FormLabel>\r\n                                <RadioGroup row\r\n                                    value={state.entityType}\r\n                                    onChange={(evt) => state.entityType = (evt.target as HTMLInputElement).value as EntityType}\r\n                                >\r\n                                    <FormControlLabel\r\n                                        disabled={state.inProgress}\r\n                                        value={\"Orchestration\"}\r\n                                        control={<Radio />}\r\n                                        label=\"Orchestrations\"\r\n                                    />\r\n                                    <FormControlLabel\r\n                                        disabled={state.inProgress}\r\n                                        value={\"DurableEntity\"}\r\n                                        control={<Radio />}\r\n                                        label=\"Durable Entities\"\r\n                                    />\r\n                                </RadioGroup>\r\n                            </FormControl>\r\n\r\n                            <KeyboardDateTimePicker\r\n                                className=\"purge-history-from-input\"\r\n                                ampm={false}\r\n                                autoOk={true}\r\n                                label=\"From (UTC)\"\r\n                                format={\"YYYY-MM-DD HH:mm:ss\"}\r\n                                variant=\"inline\"\r\n                                disabled={state.inProgress}\r\n                                value={state.timeFrom}\r\n                                onChange={(t) => state.timeFrom = DateTimeHelpers.momentAsUtc(t)}\r\n                            />\r\n\r\n                            <KeyboardDateTimePicker\r\n                                className=\"purge-history-till-input\"\r\n                                ampm={false}\r\n                                autoOk={true}\r\n                                label=\"Till (UTC)\"\r\n                                format={\"YYYY-MM-DD HH:mm:ss\"}\r\n                                variant=\"inline\"\r\n                                disabled={state.inProgress}\r\n                                value={state.timeTill}\r\n                                onChange={(t) => state.timeTill = DateTimeHelpers.momentAsUtc(t)}\r\n                            />\r\n\r\n                            <FormControl className=\"purge-history-statuses\" disabled={state.inProgress}>\r\n                                <FormLabel>With the following status:</FormLabel>\r\n\r\n                                {state.entityType === \"Orchestration\" && (\r\n                                    <FormGroup row>\r\n                                        <RuntimeStatusCheckbox state={state} runtimeStatus=\"Completed\" />\r\n                                        <RuntimeStatusCheckbox state={state} runtimeStatus=\"Failed\" />\r\n                                        <RuntimeStatusCheckbox state={state} runtimeStatus=\"Terminated\" />\r\n                                    </FormGroup>\r\n                                )}\r\n\r\n                                {state.entityType === \"DurableEntity\" && (\r\n                                    <FormGroup row>\r\n                                        <Tooltip title=\"Durable Entities are always in 'Running' state\">\r\n                                            <FormControlLabel\r\n                                                control={<Checkbox\r\n                                                    checked={true} />}\r\n                                                label=\"Running\"\r\n                                                disabled={true}\r\n                                            />\r\n                                        </Tooltip>\r\n                                    </FormGroup>\r\n                                )}\r\n                            </FormControl>\r\n\r\n                            <ErrorMessage state={state} />\r\n\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button onClick={() => state.dialogOpen = false} disabled={state.inProgress} color=\"primary\">\r\n                                Cancel\r\n                            </Button>\r\n                            <Button onClick={() => state.purgeHistory()} disabled={!state.isValid || state.inProgress} color=\"secondary\">\r\n                                Purge\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </div>\r\n                )}\r\n\r\n                {state.instancesDeleted !== null && (\r\n                    <div>\r\n                        <DialogContent>\r\n                            <DialogContentText className=\"success-message\">\r\n                                {state.instancesDeleted} instances were deleted.\r\n                            </DialogContentText>\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button onClick={() => state.dialogOpen = false} color=\"primary\">\r\n                                Close\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </div>\r\n                )}\r\n\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\n@observer\r\nclass RuntimeStatusCheckbox extends React.Component<{ state: PurgeHistoryDialogState, runtimeStatus: RuntimeStatus }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n        const runtimeStatus = this.props.runtimeStatus;\r\n\r\n        return (\r\n            <FormControlLabel\r\n                control={<Checkbox\r\n                    checked={state.getStatusIncluded(runtimeStatus)}\r\n                    onChange={(evt) => state.setStatusIncluded(runtimeStatus, evt.target.checked)} />}\r\n                label={runtimeStatus}\r\n            />\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Checkbox, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, FormControl,\r\n    FormControlLabel, FormGroup, LinearProgress, \r\n} from '@material-ui/core';\r\n\r\nimport './CleanEntityStorageDialog.css';\r\n\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { CleanEntityStorageDialogState } from '../states/CleanEntityStorageDialogState';\r\n\r\n// Dialog with parameters for cleaning entity storage\r\n@observer\r\nexport class CleanEntityStorageDialog extends React.Component<{ state: CleanEntityStorageDialogState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <Dialog open={state.dialogOpen} onClose={() => { if (!state.inProgress) state.dialogOpen = false; }}>\r\n\r\n                <DialogTitle>Clean Entity Storage</DialogTitle>\r\n\r\n                {!state.response && (<>\r\n                    <DialogContent>\r\n\r\n                        {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n\r\n                        <DialogContentText>\r\n                            An entity is considered empty, and is removed, if it has no state, is not locked, and has been idle for more than EntityMessageReorderWindowInMinutes. Locks are considered orphaned, and are released, if the orchestration that holds them is not in state Running.\r\n                        </DialogContentText>\r\n\r\n                        <FormControl className=\"purge-history-statuses\" disabled={state.inProgress}>\r\n                            <FormGroup row>\r\n\r\n                                <FormControlLabel control={<Checkbox\r\n                                    checked={state.removeEmptyEntities}\r\n                                    onChange={(evt) => state.removeEmptyEntities = evt.target.checked} />}\r\n                                    label=\"Remove Empty Entities\"\r\n                                />\r\n\r\n                                <FormControlLabel control={<Checkbox\r\n                                    checked={state.releaseOrphanedLocks}\r\n                                    onChange={(evt) => state.releaseOrphanedLocks = evt.target.checked} />}\r\n                                    label=\"Release Orphaned Locks\"\r\n                                />\r\n                                \r\n                            </FormGroup>\r\n                        </FormControl>\r\n\r\n                        <ErrorMessage state={state} />\r\n\r\n                    </DialogContent>\r\n\r\n                    <DialogActions>\r\n                        <Button onClick={() => state.dialogOpen = false} disabled={state.inProgress} color=\"primary\">\r\n                            Cancel\r\n                        </Button>\r\n                        <Button onClick={() => state.clean()} disabled={!state.isValid || state.inProgress} color=\"secondary\">\r\n                            Clean\r\n                        </Button>\r\n                    </DialogActions>\r\n                </>)}\r\n\r\n                {!!state.response && (<>\r\n                    <DialogContent>\r\n                        <DialogContentText className=\"success-message\">\r\n                            {state.response.numberOfEmptyEntitiesRemoved} empty entities removed. \r\n                        </DialogContentText>\r\n                        <DialogContentText className=\"success-message\">\r\n                            {state.response.numberOfOrphanedLocksRemoved} orphaned locks removed.\r\n                        </DialogContentText>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={() => state.dialogOpen = false} color=\"primary\">\r\n                            Close\r\n                        </Button>\r\n                    </DialogActions>\r\n                </>)}\r\n\r\n            </Dialog>\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport { AppBar, Breadcrumbs, Box, Link, Toolbar, Typography } from '@material-ui/core';\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport MomentUtils from '@date-io/moment';\r\n\r\nimport './Main.css';\r\n\r\nimport { LoginIcon } from './LoginIcon';\r\nimport { MainMenu } from './MainMenu';\r\nimport { MainState } from '../states/MainState';\r\nimport { Orchestrations } from './Orchestrations';\r\nimport { OrchestrationDetails } from './OrchestrationDetails';\r\nimport { PurgeHistoryDialog } from './PurgeHistoryDialog';\r\nimport { CleanEntityStorageDialog } from './CleanEntityStorageDialog';\r\n\r\nconst logo = require('../logo.svg');\r\n\r\n// The main application view\r\n@observer\r\nexport class Main extends React.Component<{ state: MainState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <MuiPickersUtilsProvider utils={MomentUtils}><>\r\n\r\n                {!state.loginState && (\r\n                    <Box height={20}/>\r\n                )}\r\n                \r\n                {!!state.loginState && (\r\n                    <AppBar position=\"static\" color=\"default\" className=\"app-bar\">\r\n                        <Toolbar>\r\n\r\n                            {state.loginState.isLoggedIn && !!state.mainMenuState && (\r\n                                <MainMenu state={state.mainMenuState} />\r\n                            )}\r\n\r\n                            <img src={logo} width=\"30px\"></img>\r\n                            <Box width={5} />\r\n\r\n                            <Typography variant=\"h6\" color=\"inherit\" className=\"title-typography\">\r\n                                Durable Functions Monitor\r\n                            </Typography>\r\n\r\n                            <Breadcrumbs color=\"inherit\">\r\n                                <Link color=\"inherit\" href=\"\">\r\n                                    / instances\r\n                                </Link>\r\n                                {!!state.orchestrationDetailsState && (\r\n                                    <Typography color=\"inherit\">\r\n                                        {state.orchestrationDetailsState.orchestrationId}\r\n                                    </Typography>\r\n                                )}\r\n                            </Breadcrumbs>\r\n\r\n                            <Typography style={{ flex: 1 }} />\r\n\r\n                            <LoginIcon state={state.loginState} />\r\n                        </Toolbar>\r\n                    </AppBar>\r\n                )}\r\n\r\n                {!!state.orchestrationsState && (!state.loginState || state.loginState.isLoggedIn) && (\r\n                    <Orchestrations state={state.orchestrationsState} />\r\n                )}\r\n\r\n                {!!state.orchestrationDetailsState && (!state.loginState || state.loginState.isLoggedIn) && (\r\n                    <OrchestrationDetails state={state.orchestrationDetailsState} />\r\n                )}\r\n\r\n                <PurgeHistoryDialog state={state.purgeHistoryDialogState}/>\r\n                <CleanEntityStorageDialog state={state.cleanEntityStorageDialogState} />\r\n\r\n            </></MuiPickersUtilsProvider>\r\n        );\r\n    }\r\n}","import axios, { Method } from 'axios';\r\nimport { IBackendClient } from './IBackendClient';\r\n\r\nexport const BackendUri = process.env.REACT_APP_BACKEND_BASE_URI + process.env.REACT_APP_BACKEND_PATH;\r\n\r\n// Common IBackendClient implementation, sends HTTP requests directly\r\nexport class BackendClient implements IBackendClient {\r\n\r\n    get isVsCode(): boolean { return false; }\r\n\r\n    constructor(private _getAuthorizationHeaderAsync: () => Promise<{ Authorization: string }>) {\r\n    }\r\n\r\n    call(method: Method, url: string, data?: any): Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n\r\n            this._getAuthorizationHeaderAsync().then(headers => {\r\n\r\n                axios.request({\r\n                    url: BackendUri + url,\r\n                    method, data, headers\r\n                }).then(r => { resolve(r.data); }, reject);\r\n            });\r\n        });\r\n    }\r\n}","import { action, observable, computed } from 'mobx'\r\nimport axios, { AxiosResponse } from 'axios';\r\nimport * as Msal from 'msal';\r\n\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\n\r\nimport { BackendUri } from '../services/BackendClient';\r\n\r\n// Login State\r\nexport class LoginState extends ErrorMessageState {\r\n\r\n    @computed\r\n    get isLoggedIn(): boolean { return this._isLoggedIn; };\r\n\r\n    @computed\r\n    get isLoggedInAnonymously(): boolean { return !this._userName; };\r\n\r\n    @computed\r\n    get userName(): string { return this._userName; };\r\n\r\n    @observable\r\n    menuAnchorElement?: Element;\r\n\r\n    constructor() {\r\n        super();\r\n        this.login();\r\n    }\r\n\r\n    login() {\r\n        const uri = `${BackendUri}/easyauth-config`;\r\n        axios.get(uri).then(this.loginWithEasyAuthConfig, err => {\r\n            this.errorMessage = `${err.message}.${(!!err.response ? err.response.data : '')}`;\r\n        });\r\n    }\r\n\r\n    logout() {\r\n        this.menuAnchorElement = undefined;\r\n        this._aadApp.logout();\r\n    }\r\n\r\n    @action.bound\r\n    getAuthorizationHeaderAsync() {\r\n\r\n        // Let's think we're on localhost and proceed with no auth\r\n        if (!this._aadApp) {\r\n            return new Promise<{ Authorization: string }>((resolve, reject) => resolve());\r\n        }\r\n\r\n        return new Promise<{ Authorization: string }>((resolve, reject) => {\r\n            // Obtaining a token to access our own AAD app\r\n            const authParams: Msal.AuthenticationParameters = {\r\n                scopes: [this._aadApp.getCurrentConfiguration().auth.clientId]\r\n            };\r\n\r\n            this._aadApp.acquireTokenSilent(authParams)\r\n                .then((authResponse) => {\r\n\r\n                    var accessToken = authResponse.accessToken;\r\n                    if (!accessToken) {\r\n                        // https://github.com/AzureAD/microsoft-authentication-library-for-js/issues/736\r\n                        // accessToken might randomly be returned as null, in which case we can probably use id_token\r\n                        // (which is supposed to be the same)\r\n                        console.log('DFM: accessToken is null, so using idToken.rawIdToken instead');\r\n                        accessToken = authResponse.idToken.rawIdToken;\r\n                    }\r\n\r\n                    resolve({ Authorization: `Bearer ${accessToken}` });\r\n\r\n                }, err => {\r\n                    // If silent token aquiring failed, then just redirecting the user back to AAD, \r\n                    // so that the page is reloaded anyway.\r\n                    // This is supposed to happen very rarely, as default refresh token lifetime is quite long.  \r\n                    console.log(`DFM: acquireTokenSilent() failed (${err}), so calling acquireTokenRedirect()...`);\r\n                    this._aadApp.acquireTokenRedirect(authParams);\r\n                });\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _isLoggedIn: boolean = false;\r\n\r\n    @observable\r\n    private _userName: string;\r\n\r\n    private _aadApp: Msal.UserAgentApplication;\r\n\r\n    @action.bound\r\n    private loginWithEasyAuthConfig(easyAuthConfigResponse: AxiosResponse<any>) {\r\n\r\n        const config = easyAuthConfigResponse.data;\r\n        if (!config.clientId) {\r\n            // Let's think we're on localhost and proceed with no auth\r\n            this._isLoggedIn = true;\r\n            return;\r\n        }\r\n\r\n        // Configuring MSAL with values received from backend\r\n        this._aadApp = new Msal.UserAgentApplication({\r\n            auth: {\r\n                clientId: config.clientId,\r\n                authority: config.authority\r\n            }\r\n        })\r\n\r\n        // Checking if it was a redirect from AAD\r\n        this._aadApp.handleRedirectCallback(() => { }, this.handleRedirectCallbackFailed);\r\n        const account = this._aadApp.getAccount();\r\n\r\n        if (!account) {\r\n            // Redirecting user to AAD. Redirect flow is more reliable (doesn't need popups enabled)\r\n            console.log('DFM: redirecting user to AAD for login...');\r\n            this._aadApp.loginRedirect();\r\n        } else {\r\n            // We've logged in successfully. Setting user name.\r\n            this._userName = account.userName;\r\n            this._isLoggedIn = true;\r\n        }\r\n    }\r\n\r\n    @action.bound\r\n    private handleRedirectCallbackFailed(authErr: Msal.AuthError, accountState: string) {\r\n        this.errorMessage = `Failed to handle login redirect. name: ${authErr.name}, message: ${authErr.message}, errorCode: ${authErr.errorCode}, errorMessage: ${authErr.errorMessage}, accountState: ${accountState}`;\r\n    }\r\n}","import { observable, computed } from 'mobx'\r\n\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { PurgeHistoryDialogState } from './PurgeHistoryDialogState';\r\nimport { CleanEntityStorageDialogState } from './CleanEntityStorageDialogState';\r\n\r\n// State of Main Menu component\r\nexport class MainMenuState extends ErrorMessageState {\r\n\r\n    @observable\r\n    menuAnchorElement?: Element;\r\n\r\n    @observable\r\n    hubName: string;\r\n    @observable\r\n    connectionString: string;\r\n    \r\n    @observable\r\n    connectionParamsDialogOpen: boolean = false;\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; }\r\n\r\n    @computed\r\n    get isReadonly(): boolean { return this._isReadOnly; }\r\n\r\n    @computed\r\n    get isDirty(): boolean {\r\n        return (this.connectionString !== this._oldConnectionString) || (this.hubName !== this._oldHubName);\r\n    }\r\n\r\n    constructor(private _backendClient: IBackendClient,\r\n        private _purgeHistoryDialogState: PurgeHistoryDialogState,\r\n        private _cleanEntityStorageDialogState: CleanEntityStorageDialogState) {\r\n        super();\r\n    }\r\n    \r\n    showConnectionParamsDialog() {\r\n        this.menuAnchorElement = undefined;\r\n\r\n        this.connectionParamsDialogOpen = true;\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('GET', '/manage-connection').then(response => {\r\n\r\n            this.connectionString = this._oldConnectionString = response.connectionString;\r\n            this.hubName = this._oldHubName = response.hubName;\r\n            this._isReadOnly = response.isReadOnly;\r\n\r\n        }, err => {\r\n            this.errorMessage = `Load failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    saveConnectionParams() {\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('PUT', '/manage-connection', {\r\n            connectionString: this.connectionString !== this._oldConnectionString ? this.connectionString : '',\r\n            hubName: this.hubName\r\n        }).then(() => {\r\n        \r\n            this.connectionParamsDialogOpen = false;\r\n\r\n            alert(`Your changes were saved to local.settings.json file, but they cannot be picked up automatically. Please, restart the Function Host for them to take effect.`);\r\n\r\n        }, err => {\r\n            this.errorMessage = `Save failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    showPurgeHistoryDialog() {\r\n        this.menuAnchorElement = undefined;\r\n        \r\n        this._purgeHistoryDialogState.dialogOpen = true;\r\n    }\r\n\r\n    showCleanEntityStorageDialog() {\r\n        this.menuAnchorElement = undefined;\r\n\r\n        this._cleanEntityStorageDialogState.dialogOpen = true;\r\n    }\r\n\r\n    setWindowTitle() {\r\n        \r\n        this._backendClient.call('GET', '/about').then(response => {\r\n            document.title = `Durable Functions Monitor (${response.accountName}/${response.hubName}) v${response.version}`;\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _inProgress: boolean = false;\r\n\r\n    @observable\r\n    private _isReadOnly: boolean = false;\r\n    \r\n    private _oldConnectionString: string;\r\n    private _oldHubName: string;\r\n}","import { observable, computed } from 'mobx';\r\nimport mermaid from 'mermaid';\r\n\r\nimport { DurableOrchestrationStatus, HistoryEvent } from '../states/DurableOrchestrationStatus';\r\nimport { ICustomTabState } from './OrchestrationDetailsState';\r\n\r\n// State of Sequence Diagram tab on OrchestrationDetails view\r\nexport class SequenceDiagramTabState implements ICustomTabState {\r\n\r\n    readonly name: string = \"Sequence Diagram\";\r\n\r\n    @computed\r\n    get description(): string { return this._sequenceDiagramCode; };\r\n\r\n    @computed\r\n    get rawHtml(): string { return this._sequenceDiagramSvg; };\r\n\r\n    constructor(private _loadDetails: (orchestrationId: string) => Promise<DurableOrchestrationStatus>) {\r\n    }\r\n\r\n    load(details: DurableOrchestrationStatus) : Promise<void> {\r\n\r\n        if (!this._mermaidInitialized) {\r\n            mermaid.initialize({ startOnLoad: true });\r\n            this._mermaidInitialized = true;\r\n        }\r\n\r\n        if (!!this._sequenceDiagramSvg || !details.historyEvents) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return new Promise<void>((resolve, reject) => {\r\n            Promise.all(this.getSequenceForOrchestration(details.name, '.', details.historyEvents)).then(sequenceLines => {\r\n\r\n                const sequenceCode = 'sequenceDiagram \\n' + sequenceLines.join('');\r\n\r\n                try {\r\n\r\n                    mermaid.render('mermaidSvgId', sequenceCode, (svg) => {\r\n                        this._sequenceDiagramCode = sequenceCode;\r\n                        this._sequenceDiagramSvg = svg;\r\n                        resolve();\r\n                    });\r\n                    \r\n                } catch (err) {\r\n                    reject(err);\r\n                }\r\n\r\n            }, reject);\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _sequenceDiagramCode: string;\r\n    @observable\r\n    private _sequenceDiagramSvg: string;\r\n    private _mermaidInitialized = false;\r\n\r\n    private getSequenceForOrchestration(orchestrationName: string,\r\n        parentOrchestrationName: string,\r\n        historyEvents: HistoryEvent[]): Promise<string>[] {\r\n\r\n        const externalActor = '.'\r\n        const results: Promise<string>[] = [];\r\n\r\n        for (var event of historyEvents) {\r\n\r\n            switch (event.EventType) {\r\n                case 'ExecutionStarted':\r\n\r\n                    var nextLine = `${parentOrchestrationName}->>+${orchestrationName}:[ExecutionStarted] \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n                case 'SubOrchestrationInstanceCompleted':\r\n\r\n                    if (!!event.SubOrchestrationId) {\r\n\r\n                        const subOrchestrationName = event.FunctionName;\r\n\r\n                        results.push(new Promise<string>((resolve, reject) => {\r\n                            this._loadDetails(event.SubOrchestrationId).then(details => {\r\n\r\n                                Promise.all(this.getSequenceForOrchestration(details.name, orchestrationName, details.historyEvents)).then(sequenceLines => {\r\n\r\n                                    resolve(sequenceLines.join(''));\r\n\r\n                                }, reject);\r\n\r\n                            }, err => {\r\n\r\n                                console.log(`Failed to load ${subOrchestrationName}. ${err.message}`);\r\n                                resolve(`${orchestrationName}-x${subOrchestrationName}:[FailedToLoad] \\n`);\r\n                            });\r\n                        }));\r\n                    }\r\n\r\n                    break;\r\n                case 'SubOrchestrationInstanceFailed':\r\n\r\n                    var nextLine = `${orchestrationName}-x${event.FunctionName}:[SubOrchestrationInstanceFailed] \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n                case 'TaskCompleted':\r\n\r\n                    var nextLine = `${orchestrationName}->>${orchestrationName}:${event.FunctionName} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n                case 'TaskFailed':\r\n\r\n                    var nextLine = `${orchestrationName}-x${orchestrationName}:${event.FunctionName}(failed) \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n                case 'EventRaised':\r\n\r\n                    var nextLine = `${externalActor}->>${orchestrationName}:${event.Name} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n                case 'TimerFired':\r\n\r\n                    var nextLine = `${externalActor}->>${orchestrationName}:[TimerFired] \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n                case 'ExecutionCompleted':\r\n\r\n                    var nextLine = `${orchestrationName}-->>-${parentOrchestrationName}:[ExecutionCompleted] \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n            }\r\n        }\r\n\r\n        return results;\r\n    }\r\n}","import { observable, computed } from 'mobx';\r\n\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\nimport { ICustomTabState } from './OrchestrationDetailsState';\r\n\r\n// State of a custom liquid markup tab on OrchestrationDetails view\r\nexport class LiquidMarkupTabState implements ICustomTabState {\r\n\r\n    readonly description: string = \"\";\r\n\r\n    @computed\r\n    get rawHtml(): string { return this._rawHtml; };\r\n\r\n    constructor(readonly name: string,\r\n        private _orchestrationId: string,\r\n        private _backendClient: IBackendClient) {\r\n    }\r\n\r\n    load(details: DurableOrchestrationStatus): Promise<void> {\r\n        \r\n        if (!!this._rawHtml) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return new Promise<void>((resolve, reject) => {\r\n\r\n            const uri = `/orchestrations('${this._orchestrationId}')/custom-tab-markup('${this.name}')`;\r\n\r\n            this._backendClient.call('POST', uri).then(response => { \r\n\r\n                this._rawHtml = response;\r\n                console.log(this._rawHtml);\r\n                resolve();\r\n\r\n            }, reject);\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _rawHtml: string;\r\n}","import { observable, computed } from 'mobx';\r\n\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { ITypedLocalStorage } from './ITypedLocalStorage';\r\nimport { SequenceDiagramTabState } from './SequenceDiagramTabState';\r\nimport { LiquidMarkupTabState } from './LiquidMarkupTabState';\r\n\r\n// Represents states of custom tabs\r\nexport interface ICustomTabState {\r\n\r\n    name: string;\r\n    description: string;\r\n    rawHtml: string;\r\n\r\n    load(details: DurableOrchestrationStatus): Promise<void>;\r\n}\r\n\r\n// State of OrchestrationDetails view\r\nexport class OrchestrationDetailsState extends ErrorMessageState {\r\n\r\n    // Tab currently selected\r\n    @computed\r\n    get selectedTabIndex(): number { return this._selectedTabIndex; }\r\n    set selectedTabIndex(val: number) {\r\n\r\n        this._selectedTabIndex = val;\r\n        this.loadCustomTabIfNeeded();\r\n    }\r\n\r\n    get selectedTab(): ICustomTabState {\r\n        return !this._selectedTabIndex ? null : this._tabStates[this._selectedTabIndex - 1];\r\n    }\r\n\r\n    @observable\r\n    details: DurableOrchestrationStatus = new DurableOrchestrationStatus();\r\n\r\n    @computed\r\n    get orchestrationId(): string { return this._orchestrationId; }\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; };\r\n\r\n    @computed\r\n    get autoRefresh(): number { return this._autoRefresh; }\r\n    set autoRefresh(val: number) {\r\n        this._autoRefresh = val;\r\n        this._localStorage.setItem('autoRefresh', this._autoRefresh.toString());\r\n        this.loadDetails();\r\n    }\r\n\r\n    @computed\r\n    get raiseEventDialogOpen(): boolean { return this._raiseEventDialogOpen; }\r\n    set raiseEventDialogOpen(val: boolean) {\r\n        this._raiseEventDialogOpen = val;\r\n        this.eventName = '';\r\n        this.eventData = '';\r\n    }\r\n\r\n    @computed\r\n    get setCustomStatusDialogOpen(): boolean { return this._setCustomStatusDialogOpen; }\r\n    set setCustomStatusDialogOpen(val: boolean) {\r\n        this._setCustomStatusDialogOpen = val;\r\n        this.newCustomStatus = !!this.details.customStatus ? JSON.stringify(this.details.customStatus) : '';\r\n    }\r\n\r\n    @computed\r\n    get isCustomStatusDirty(): boolean { \r\n\r\n        if (!this.details.customStatus) {\r\n            return !!this.newCustomStatus;\r\n        }\r\n\r\n        return this.newCustomStatus !== JSON.stringify(this.details.customStatus);\r\n    }\r\n\r\n    @observable\r\n    rewindConfirmationOpen: boolean = false;\r\n    @observable\r\n    terminateConfirmationOpen: boolean = false;\r\n    @observable\r\n    purgeConfirmationOpen: boolean = false;\r\n\r\n    @observable\r\n    eventName: string;\r\n    @observable\r\n    eventData: string;\r\n    @observable\r\n    newCustomStatus: string;\r\n\r\n    @computed\r\n    get tabStates(): ICustomTabState[] { return this._tabStates; }\r\n\r\n    get backendClient(): IBackendClient { return this._backendClient; }\r\n\r\n    constructor(private _orchestrationId: string,\r\n        private _backendClient: IBackendClient,\r\n        private _localStorage: ITypedLocalStorage<OrchestrationDetailsState>) {\r\n        super();\r\n\r\n        const autoRefreshString = this._localStorage.getItem('autoRefresh');\r\n        if (!!autoRefreshString) {\r\n            this._autoRefresh = Number(autoRefreshString);\r\n        }\r\n    }\r\n\r\n    rewind() {\r\n        this.rewindConfirmationOpen = false;\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/rewind`;\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to rewind: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    terminate() {\r\n        this.terminateConfirmationOpen = false;\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/terminate`;\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to terminate: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    purge() {\r\n        this.purgeConfirmationOpen = false;\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/purge`;\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri).then(() => {\r\n            this._inProgress = false;\r\n            this.details = new DurableOrchestrationStatus();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to purge: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    raiseEvent() {\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/raise-event`;\r\n        const requestBody = { name: this.eventName, data: null };\r\n\r\n        try {\r\n            requestBody.data = JSON.parse(this.eventData);\r\n        } catch (err) {\r\n            this.errorMessage = `Failed to parse event data: ${err.message}`;\r\n            return;\r\n        } finally {\r\n            this.raiseEventDialogOpen = false;\r\n        }\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri, requestBody).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to raise an event: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    setCustomStatus() {\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/set-custom-status`;\r\n        var requestBody = null;\r\n\r\n        try {\r\n\r\n            if (!!this.newCustomStatus) {\r\n                requestBody = JSON.parse(this.newCustomStatus);\r\n            }\r\n\r\n        } catch (err) {\r\n            this.errorMessage = `Failed to parse custom status: ${err.message}`;\r\n            return;\r\n        } finally {\r\n            this.setCustomStatusDialogOpen = false;\r\n        }\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri, requestBody).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to set custom status: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n    \r\n    loadDetails() {\r\n\r\n        if (!!this.inProgress) {\r\n            // Doing auto-refresh\r\n            this.setAutoRefresh();\r\n            return;\r\n        }\r\n        this._inProgress = true;\r\n        this._tabStates = [];\r\n\r\n        this.internalLoadDetails(this._orchestrationId).then(response => {\r\n        \r\n            this.details = response;\r\n\r\n            // Doing auto-refresh\r\n            this.setAutoRefresh();\r\n\r\n            // Loading custom tabs\r\n            if (this.details.entityType === \"Orchestration\") {\r\n                \r\n                this._tabStates.push(new SequenceDiagramTabState((orchId) => this.internalLoadDetails(orchId)));\r\n            }\r\n            if (!!this.details.tabTemplateNames) {\r\n                for (var templateName of this.details.tabTemplateNames) {\r\n                    this._tabStates.push(new LiquidMarkupTabState(templateName, this._orchestrationId, this._backendClient));\r\n                }                \r\n            }\r\n\r\n            this._inProgress = false;\r\n\r\n            // Reloading the current custom tab as well\r\n            this.loadCustomTabIfNeeded();\r\n            \r\n        }, err => {\r\n            this._inProgress = false;\r\n\r\n            // Cancelling auto-refresh just in case\r\n            this._autoRefresh = 0;\r\n\r\n            this.errorMessage = `Load failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    private loadCustomTabIfNeeded(): void {\r\n\r\n        if (!!this._inProgress || !this._selectedTabIndex) {\r\n            return;\r\n        }\r\n\r\n        this._inProgress = true;\r\n\r\n        this.selectedTab.load(this.details).then(() => {}, err => { \r\n                \r\n            // Cancelling auto-refresh just in case\r\n            this._autoRefresh = 0;\r\n\r\n            this.errorMessage = `Failed to load Sequence Diagram: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    private setAutoRefresh(): void {\r\n\r\n        if (!this._autoRefresh) {\r\n            return;\r\n        }\r\n\r\n        if (!!this._autoRefreshToken) {\r\n            clearTimeout(this._autoRefreshToken);\r\n        }\r\n        this._autoRefreshToken = setTimeout(() => this.loadDetails(), this._autoRefresh * 1000);\r\n    }\r\n\r\n    @observable\r\n    private _tabStates: ICustomTabState[] = [];\r\n\r\n    @observable\r\n    private _selectedTabIndex: number = 0;\r\n    @observable\r\n    private _inProgress: boolean = false;\r\n    @observable\r\n    _raiseEventDialogOpen: boolean = false;\r\n    @observable\r\n    _setCustomStatusDialogOpen: boolean = false;\r\n    @observable\r\n    private _autoRefresh: number = 0;\r\n\r\n    private _autoRefreshToken: NodeJS.Timeout;\r\n\r\n    private internalLoadDetails(orchestrationId: string): Promise<DurableOrchestrationStatus> {\r\n\r\n        const uri = `/orchestrations('${orchestrationId}')`;\r\n        return this._backendClient.call('GET', uri).then(response => {\r\n\r\n            if (!response) {\r\n                throw { message: `Orchestration '${orchestrationId}' not found.` };\r\n            }\r\n\r\n            // Based on backend implementation, this field can appear to be called differently ('historyEvents' vs. 'history')\r\n            // Fixing that here\r\n            if (!!response.history) {\r\n                response.historyEvents = response.history;\r\n            }\r\n\r\n            return response;\r\n        });\r\n    }\r\n}","import { observable, computed } from 'mobx'\r\nimport moment from 'moment';\r\n\r\nimport { DateTimeHelpers } from '../DateTimeHelpers';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { RuntimeStatus, EntityType } from './DurableOrchestrationStatus';\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\n\r\n// State of Purge History Dialog\r\nexport class PurgeHistoryDialogState extends ErrorMessageState {\r\n\r\n    @computed\r\n    get dialogOpen(): boolean { return this._dialogOpen; };\r\n    set dialogOpen(value: boolean) {\r\n        this._dialogOpen = value;\r\n\r\n        if (value) {\r\n\r\n            this._instancesDeleted = null;\r\n\r\n            this.timeFrom = moment().subtract(1, 'days').utc();\r\n            this.timeTill = moment().utc();\r\n\r\n            this._statuses = new Set<RuntimeStatus>([\"Completed\", \"Terminated\"]);\r\n\r\n            this.entityType = \"Orchestration\";\r\n        }\r\n    }\r\n\r\n    @computed\r\n    get instancesDeleted(): number | null { return this._instancesDeleted; };\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; };\r\n\r\n    @computed\r\n    get isValid(): boolean {\r\n        return this._statuses.size > 0 && DateTimeHelpers.isValidMoment(this.timeFrom) && DateTimeHelpers.isValidMoment(this.timeTill);\r\n    };\r\n\r\n    constructor(private _backendClient: IBackendClient) {\r\n        super();\r\n    }\r\n\r\n    purgeHistory() {\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', '/purge-history', {\r\n            entityType: this.entityType,\r\n            timeFrom: this.timeFrom.toISOString(),\r\n            timeTill: this.timeTill.toISOString(),\r\n            statuses: Array.from(this._statuses.values())\r\n        }).then(response => {\r\n\r\n            this._instancesDeleted = response.instancesDeleted;\r\n\r\n        }, err => {\r\n            this.errorMessage = `Purge history failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    @observable\r\n    timeFrom: moment.Moment;\r\n    @observable\r\n    timeTill: moment.Moment;\r\n\r\n    @observable\r\n    entityType: EntityType = \"Orchestration\";\r\n\r\n    getStatusIncluded(status: RuntimeStatus) {\r\n        return this._statuses.has(status);\r\n    }\r\n\r\n    setStatusIncluded(status: RuntimeStatus, included: boolean) {\r\n        if (included) {\r\n            this._statuses.add(status);\r\n        } else {\r\n            this._statuses.delete(status);\r\n        }\r\n    }\r\n\r\n    @observable\r\n    private _statuses: Set<RuntimeStatus> = new Set<RuntimeStatus>();\r\n\r\n    @observable\r\n    private _dialogOpen: boolean = false;\r\n    \r\n    @observable\r\n    private _inProgress: boolean = false;\r\n\r\n    @observable\r\n    private _instancesDeleted: number | null = null;\r\n}","import { observable, computed } from 'mobx'\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\n\r\n// State of Clean Entity Storage Dialog\r\nexport class CleanEntityStorageDialogState extends ErrorMessageState {\r\n\r\n    @computed\r\n    get dialogOpen(): boolean { return this._dialogOpen; };\r\n    set dialogOpen(isOpen: boolean) {\r\n        this._dialogOpen = isOpen;\r\n\r\n        if (isOpen) {\r\n            this._response = null;\r\n            this.removeEmptyEntities = true;\r\n            this.releaseOrphanedLocks = true;\r\n        }\r\n    }\r\n\r\n    @computed\r\n    get response(): CleanEntityStorageResponse | null { return this._response; };\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; };\r\n\r\n    @computed\r\n    get isValid(): boolean {\r\n        return true;\r\n    };\r\n\r\n    @observable\r\n    removeEmptyEntities: boolean;\r\n    @observable\r\n    releaseOrphanedLocks: boolean;\r\n    \r\n    constructor(private _backendClient: IBackendClient) {\r\n        super();\r\n    }\r\n\r\n    clean() {\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', '/clean-entity-storage', {\r\n            removeEmptyEntities: this.removeEmptyEntities,\r\n            releaseOrphanedLocks: this.releaseOrphanedLocks\r\n        }).then(response => {\r\n            this._response = response;\r\n        }, err => {\r\n            this.errorMessage = `Clean Entity Storage failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _dialogOpen: boolean = false;\r\n    \r\n    @observable\r\n    private _inProgress: boolean = false;\r\n\r\n    @observable\r\n    private _response: CleanEntityStorageResponse | null = null;\r\n}\r\n\r\nexport class CleanEntityStorageResponse\r\n{\r\n    numberOfEmptyEntitiesRemoved: number;\r\n    numberOfOrphanedLocksRemoved: number;\r\n}","import { ITypedLocalStorage } from './ITypedLocalStorage';\r\n\r\n// Stores field values in a localStorage\r\nexport class TypedLocalStorage<T> implements ITypedLocalStorage<T>\r\n{\r\n    constructor(private _prefix: string) { }\r\n\r\n    setItem(fieldName: Extract<keyof T, string>, value: string) {\r\n        localStorage.setItem(`${this._prefix}::${fieldName}`, value);\r\n    }\r\n\r\n    setItems(items: { fieldName: Extract<keyof T, string>, value: string | null }[]) {\r\n        for (const item of items) {\r\n            if (item.value === null) {\r\n                localStorage.removeItem(`${this._prefix}::${item.fieldName}`);\r\n            } else {\r\n                localStorage.setItem(`${this._prefix}::${item.fieldName}`, item.value);\r\n            }\r\n        }\r\n    }\r\n\r\n    getItem(fieldName: Extract<keyof T, string>): string | null {\r\n        return localStorage.getItem(`${this._prefix}::${fieldName}`);\r\n    }\r\n\r\n    removeItem(fieldName: Extract<keyof T, string>) {\r\n        localStorage.removeItem(`${this._prefix}::${fieldName}`);\r\n    }\r\n}\r\n","import { Method } from 'axios';\r\nimport { IBackendClient } from './IBackendClient';\r\n\r\n// IBackendClient implementation for VsCode extension, forwards HTTP requests to VsCode\r\nexport class VsCodeBackendClient implements IBackendClient {\r\n\r\n    get isVsCode(): boolean { return true; }\r\n\r\n    constructor(private _vsCodeApi: any) {\r\n\r\n        // Handling responses from VsCode\r\n        window.addEventListener('message', event => {\r\n\r\n            const message = event.data;\r\n\r\n            // handling menu commands\r\n            const requestHandler = this._handlers[message.id];\r\n            if (!!requestHandler) {\r\n\r\n                try {\r\n                    requestHandler(message.data);\r\n                } catch(err) {\r\n                    console.log('Failed to handle response from VsCode: ' + err);\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            // handling HTTP responses\r\n            const requestPromise = this._requests[message.id];\r\n            if (!requestPromise) {\r\n                return;\r\n            }\r\n\r\n            if (!!message.err) {\r\n                requestPromise.reject(message.err);\r\n            } else {\r\n                requestPromise.resolve(message.data);\r\n            }\r\n\r\n            delete this._requests[message.id];\r\n        });\r\n    }\r\n\r\n    call(method: Method | 'OpenInNewWindow', url: string, data?: any): Promise<any> {\r\n\r\n        const requestId = Math.random().toString();\r\n\r\n        // Sending request to VsCode\r\n        this._vsCodeApi.postMessage({ id: requestId, method, url, data });\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            this._requests[requestId] = { resolve, reject };\r\n        });\r\n    }\r\n\r\n    setCustomHandlers(purgeHistoryHandler: () => void, cleanEntityStorageHandler: () => void) {\r\n\r\n        this._handlers['purgeHistory'] = purgeHistoryHandler;\r\n        this._handlers['cleanEntityStorage'] = cleanEntityStorageHandler;\r\n\r\n        // Notifying VsCode that we're ready to process messages\r\n        // Cannot do this in ctor, because VsCodeBackendClient and PurgeHistoryDialogState depend on each other\r\n        this._vsCodeApi.postMessage({ method: 'IAmReady' });\r\n    }\r\n\r\n    private _handlers: {\r\n        [id: string]: (data: any) => void\r\n    } = {};\r\n\r\n    private _requests: {\r\n        [id: string]: {\r\n            resolve: (value?: any) => void,\r\n            reject: (reason?: any) => void\r\n        }\r\n    } = {};\r\n}","import { ITypedLocalStorage } from './ITypedLocalStorage';\r\n\r\n// Stores field values in VsCode\r\nexport class VsCodeTypedLocalStorage<T> implements ITypedLocalStorage<T>\r\n{\r\n    constructor(private _prefix: string, private _vsCodeApi: any) { \r\n\r\n        const oldState = this._vsCodeApi.getState();\r\n        VsCodeTypedLocalStorage.State = !oldState ? {} : oldState;\r\n    }\r\n\r\n    setItem(fieldName: Extract<keyof T, string>, value: string) {\r\n\r\n        VsCodeTypedLocalStorage.State[`${this._prefix}::${fieldName}`] = value;\r\n        this._vsCodeApi.setState(VsCodeTypedLocalStorage.State);\r\n    }\r\n\r\n    setItems(items: { fieldName: Extract<keyof T, string>, value: string | null }[]) {\r\n\r\n        for (const item of items) {\r\n\r\n            if (item.value === null) {\r\n                delete VsCodeTypedLocalStorage.State[`${this._prefix}::${item.fieldName}`];\r\n            } else {\r\n                VsCodeTypedLocalStorage.State[`${this._prefix}::${item.fieldName}`] = item.value;\r\n            }\r\n        }\r\n        this._vsCodeApi.setState(VsCodeTypedLocalStorage.State);\r\n    }\r\n\r\n    getItem(fieldName: Extract<keyof T, string>): string | null {\r\n        return VsCodeTypedLocalStorage.State[`${this._prefix}::${fieldName}`];\r\n    }\r\n\r\n    removeItem(fieldName: Extract<keyof T, string>) {\r\n\r\n        delete VsCodeTypedLocalStorage.State[`${this._prefix}::${fieldName}`];\r\n        this._vsCodeApi.setState(VsCodeTypedLocalStorage.State);\r\n    }\r\n\r\n    private static State = {};\r\n}\r\n","import * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\n\r\nimport registerServiceWorker from './registerServiceWorker';\r\n\r\nimport './index.css';\r\n\r\nimport { Main } from './components/Main';\r\nimport { MainState } from './states/MainState';\r\n\r\n// This is the app's global state. It consists of multiple parts, consumed by multiple nested components\r\nconst appState = new MainState();\r\n\r\nReactDOM.render(\r\n    <Main state={appState}/>,\r\n    document.getElementById('root') as HTMLElement\r\n);\r\n\r\nregisterServiceWorker();\r\n","import { BackendClient } from '../services/BackendClient';\r\nimport { LoginState } from './LoginState';\r\nimport { MainMenuState } from './MainMenuState';\r\nimport { OrchestrationsState } from './OrchestrationsState';\r\nimport { OrchestrationDetailsState } from './OrchestrationDetailsState';\r\nimport { PurgeHistoryDialogState } from './PurgeHistoryDialogState';\r\nimport { CleanEntityStorageDialogState } from './CleanEntityStorageDialogState';\r\nimport { TypedLocalStorage } from './TypedLocalStorage';\r\nimport { VsCodeBackendClient } from '../services/VsCodeBackendClient';\r\nimport { VsCodeTypedLocalStorage } from './VsCodeTypedLocalStorage';\r\n\r\n// This method is provided by VsCode, when running inside a WebView\r\ndeclare const acquireVsCodeApi: () => any;\r\n\r\n// A global variable declared in index.html and replaced by VsCode extension\r\ndeclare const OrchestrationIdFromVsCode: string;\r\n\r\n// Main Application State\r\nexport class MainState  {\r\n    \r\n    loginState?: LoginState;    \r\n    mainMenuState?: MainMenuState;\r\n    orchestrationsState?: OrchestrationsState;\r\n    orchestrationDetailsState?: OrchestrationDetailsState;\r\n    purgeHistoryDialogState: PurgeHistoryDialogState;\r\n    cleanEntityStorageDialogState: CleanEntityStorageDialogState;\r\n\r\n    constructor() {\r\n\r\n        // checking whether we're inside VsCode\r\n        var vsCodeApi: any = undefined;\r\n        try {\r\n            vsCodeApi = acquireVsCodeApi();\r\n        } catch { }\r\n\r\n        if (!!vsCodeApi) {\r\n\r\n            const backendClient = new VsCodeBackendClient(vsCodeApi);\r\n\r\n            this.purgeHistoryDialogState = new PurgeHistoryDialogState(backendClient);\r\n            this.cleanEntityStorageDialogState = new CleanEntityStorageDialogState(backendClient);\r\n\r\n            if (!!this.orchestrationId) {\r\n                this.orchestrationDetailsState = new OrchestrationDetailsState(this.orchestrationId,\r\n                    backendClient,\r\n                    new VsCodeTypedLocalStorage<OrchestrationDetailsState>('OrchestrationDetailsState', vsCodeApi));\r\n            } else {\r\n                this.orchestrationsState = new OrchestrationsState(backendClient,\r\n                    new VsCodeTypedLocalStorage<OrchestrationsState>('OrchestrationsState', vsCodeApi));\r\n\r\n                backendClient.setCustomHandlers(\r\n                    () => this.purgeHistoryDialogState.dialogOpen = true,\r\n                    () => this.cleanEntityStorageDialogState.dialogOpen = true\r\n                );\r\n            }\r\n            \r\n        } else {\r\n\r\n            this.loginState = new LoginState();\r\n\r\n            const backendClient = new BackendClient(this.loginState.getAuthorizationHeaderAsync);\r\n\r\n            this.purgeHistoryDialogState = new PurgeHistoryDialogState(backendClient);\r\n            this.cleanEntityStorageDialogState = new CleanEntityStorageDialogState(backendClient);\r\n\r\n            if (!!this.orchestrationId) {\r\n                this.orchestrationDetailsState = new OrchestrationDetailsState(this.orchestrationId,\r\n                    backendClient, \r\n                    new TypedLocalStorage<OrchestrationDetailsState>('OrchestrationDetailsState'));\r\n            } else {\r\n                this.mainMenuState = new MainMenuState(backendClient, this.purgeHistoryDialogState, this.cleanEntityStorageDialogState);\r\n                this.orchestrationsState = new OrchestrationsState(backendClient,\r\n                    new TypedLocalStorage<OrchestrationsState>('OrchestrationsState'));\r\n            }\r\n        }\r\n    }\r\n\r\n    // Extracts orchestrationId from URL or from VsCode\r\n    private get orchestrationId(): string {\r\n\r\n        if (!!OrchestrationIdFromVsCode) {\r\n            return OrchestrationIdFromVsCode;\r\n        }\r\n\r\n        const uriSuffix = `/orchestrations/`;\r\n        if (!window.location.pathname.startsWith(uriSuffix)) {\r\n            return '';\r\n        }\r\n\r\n        return window.location.pathname.substr(uriSuffix.length);\r\n    }\r\n}"],"sourceRoot":""}